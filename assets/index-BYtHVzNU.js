(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const u of document.querySelectorAll('link[rel="modulepreload"]'))A(u);new MutationObserver(u=>{for(const P of u)if(P.type==="childList")for(const r of P.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&A(r)}).observe(document,{childList:!0,subtree:!0});function m(u){const P={};return u.integrity&&(P.integrity=u.integrity),u.referrerPolicy&&(P.referrerPolicy=u.referrerPolicy),u.crossOrigin==="use-credentials"?P.credentials="include":u.crossOrigin==="anonymous"?P.credentials="omit":P.credentials="same-origin",P}function A(u){if(u.ep)return;u.ep=!0;const P=m(u);fetch(u.href,P)}})();var St;(function(C){C.IMAGE="image"})(St||(St={}));class ft{static getFileInfo(s){return{name:s.name,size:s.size,type:s.type,lastModified:new Date(s.lastModified)}}static getFileType(s){return s.type.toLowerCase().startsWith("image/")?St.IMAGE:null}static isImageFile(s){return["image/jpeg","image/jpg","image/png","image/gif","image/webp","image/svg+xml","image/bmp","image/tiff","image/tif"].includes(s.type.toLowerCase())||this.isTiffByExtension(s.name)}static isTiffByExtension(s){const m=s.toLowerCase().split(".").pop();return m==="tiff"||m==="tif"}static formatFileSize(s){if(s===0)return"0 Bytes";const m=1024,A=["Bytes","KB","MB","GB"],u=Math.floor(Math.log(s)/Math.log(m));return parseFloat((s/Math.pow(m,u)).toFixed(2))+" "+A[u]}static createDataURL(s){return new Promise((m,A)=>{const u=new FileReader;u.onload=P=>{P.target?.result?m(P.target.result):A(new Error("Failed to read file"))},u.onerror=()=>A(new Error("Error reading file")),u.readAsDataURL(s)})}}class er{constructor(s,m=50){this._subscribers=new Set,this._history=[],this._state=this.deepFreeze(s),this._maxHistorySize=m}getState(){return this._state}setState(s,m="unknown"){const A=this._state,u=s(A),P=this.deepFreeze({...u});return this.isEqual(A,P)||(this._state=P,this.recordTransition(A,P,m),this.notifySubscribers(P,A)),P}subscribe(s){return this._subscribers.add(s),()=>{this._subscribers.delete(s)}}getHistory(){return[...this._history]}clearHistory(){this._history=[]}revertToState(s,m="revert"){return this.setState(()=>s,m)}destroy(){this._subscribers.clear(),this._history=[]}notifySubscribers(s,m){setTimeout(()=>{this._subscribers.forEach(A=>{try{A(s,m)}catch(u){console.error("StateManager: Subscriber error:",u)}})},0)}recordTransition(s,m,A){const u={previous:s,current:m,timestamp:Date.now(),source:A};this._history.push(u),this._history.length>this._maxHistorySize&&(this._history=this._history.slice(-this._maxHistorySize))}deepFreeze(s){const m=Object.getOwnPropertyNames(s);for(const A of m){const u=s[A];u&&typeof u=="object"&&this.deepFreeze(u)}return Object.freeze(s)}isEqual(s,m){if(s===m)return!0;if(typeof s!="object"||typeof m!="object"||s===null||m===null)return!1;const A=Object.keys(s),u=Object.keys(m);if(A.length!==u.length)return!1;for(const P of A)if(!u.includes(P)||s[P]!==m[P])return!1;return!0}}class tr extends er{constructor(){super({currentPage:0,totalPages:0,isLoading:!1,isProcessing:!1})}startLoading(s){return this.setState(m=>({...m,isLoading:!0,isProcessing:!1,error:void 0,fileInfo:s}),"startLoading")}finishLoading(s){return this.setState(m=>({...m,isLoading:!1,totalPages:s,currentPage:s>0?0:m.currentPage,loadedAt:new Date}),"finishLoading")}startProcessing(){return this.setState(s=>({...s,isProcessing:!0,error:void 0}),"startProcessing")}finishProcessing(){return this.setState(s=>({...s,isProcessing:!1}),"finishProcessing")}setError(s){return this.setState(m=>({...m,isLoading:!1,isProcessing:!1,error:s}),"setError")}navigateToPage(s){return this.setState(m=>s<0||s>=m.totalPages?(console.warn(`Invalid page index: ${s} (total: ${m.totalPages})`),m):{...m,currentPage:s},"navigateToPage")}nextPage(){return this.setState(s=>{const m=s.currentPage+1;return m>=s.totalPages?s:{...s,currentPage:m}},"nextPage")}previousPage(){return this.setState(s=>{const m=s.currentPage-1;return m<0?s:{...s,currentPage:m}},"previousPage")}reset(){return this.setState(()=>({currentPage:0,totalPages:0,isLoading:!1,isProcessing:!1}),"reset")}getPaginationInfo(){const s=this.getState();return s.totalPages<=1?null:{currentPage:s.currentPage+1,totalPages:s.totalPages,canGoNext:s.currentPage<s.totalPages-1,canGoPrevious:s.currentPage>0}}isLoading(){return this.getState().isLoading}isProcessing(){return this.getState().isProcessing}hasError(){return!!this.getState().error}subscribeToLoading(s){return this.subscribe((m,A)=>{m.isLoading!==A.isLoading&&s(m.isLoading)})}subscribeToPageChanges(s){return this.subscribe((m,A)=>{(m.currentPage!==A.currentPage||m.totalPages!==A.totalPages)&&s(m.currentPage,m.totalPages)})}subscribeToErrors(s){return this.subscribe((m,A)=>{m.error!==A.error&&s(m.error)})}clearError(){this.setState(s=>({...s,error:void 0}))}resetState(){this.setState(()=>this.getInitialState())}getInitialState(){return{currentPage:0,totalPages:0,isLoading:!1,isProcessing:!1,error:void 0,fileInfo:void 0}}}class rr{constructor(s){this.subscriptions=[],this.stateManager=s||new tr,this.setupEventForwarding()}getState(){return this.stateManager.getState()}subscribe(s){return this.stateManager.subscribe(s)}async nextPage(){const s=this.stateManager.getState();s.currentPage<s.totalPages-1&&await this.navigateToPage(s.currentPage+1)}async previousPage(){const s=this.stateManager.getState();s.currentPage>0&&await this.navigateToPage(s.currentPage-1)}canGoNext(){const s=this.stateManager.getState();return s.currentPage<s.totalPages-1}canGoPrevious(){return this.stateManager.getState().currentPage>0}getPaginationInfo(){return this.stateManager.getPaginationInfo()}setupEventForwarding(){this.subscriptions.push(this.stateManager.subscribe((s,m)=>{if(this.eventTarget&&this.eventTarget.dispatchEvent(new CustomEvent("stateChange",{detail:{current:s,previous:m}})),s.isLoading!==m.isLoading){const A=s.isLoading?"loadingStart":"loadingEnd";this.eventTarget&&this.eventTarget.dispatchEvent(new CustomEvent(A,{detail:s}))}s.currentPage!==m.currentPage&&this.eventTarget&&this.eventTarget.dispatchEvent(new CustomEvent("pageChanged",{detail:{currentPage:s.currentPage,totalPages:s.totalPages}})),s.error&&s.error!==m.error&&this.eventTarget&&this.eventTarget.dispatchEvent(new CustomEvent("error",{detail:{error:s.error}})),!s.isLoading&&m.isLoading&&!s.error&&this.eventTarget&&this.eventTarget.dispatchEvent(new CustomEvent("loaded",{detail:{totalPages:s.totalPages,state:s}}))}))}setEventTarget(s){this.eventTarget=s}destroy(){this.subscriptions.forEach(s=>s()),this.subscriptions=[],this.stateManager.destroy(),this.eventTarget=void 0}}function ar(C){throw new Error('Could not dynamically require "'+C+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var ct={exports:{}},ut={},Dt;function je(){return Dt||(Dt=1,function(C){var s=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function m(P,r){return Object.prototype.hasOwnProperty.call(P,r)}C.assign=function(P){for(var r=Array.prototype.slice.call(arguments,1);r.length;){var t=r.shift();if(t){if(typeof t!="object")throw new TypeError(t+"must be non-object");for(var a in t)m(t,a)&&(P[a]=t[a])}}return P},C.shrinkBuf=function(P,r){return P.length===r?P:P.subarray?P.subarray(0,r):(P.length=r,P)};var A={arraySet:function(P,r,t,a,w){if(r.subarray&&P.subarray){P.set(r.subarray(t,t+a),w);return}for(var v=0;v<a;v++)P[w+v]=r[t+v]},flattenChunks:function(P){var r,t,a,w,v,f;for(a=0,r=0,t=P.length;r<t;r++)a+=P[r].length;for(f=new Uint8Array(a),w=0,r=0,t=P.length;r<t;r++)v=P[r],f.set(v,w),w+=v.length;return f}},u={arraySet:function(P,r,t,a,w){for(var v=0;v<a;v++)P[w+v]=r[t+v]},flattenChunks:function(P){return[].concat.apply([],P)}};C.setTyped=function(P){P?(C.Buf8=Uint8Array,C.Buf16=Uint16Array,C.Buf32=Int32Array,C.assign(C,A)):(C.Buf8=Array,C.Buf16=Array,C.Buf32=Array,C.assign(C,u))},C.setTyped(s)}(ut)),ut}var Qe={},Oe={},We={},Pt;function ir(){if(Pt)return We;Pt=1;var C=je(),s=4,m=0,A=1,u=2;function P(h){for(var U=h.length;--U>=0;)h[U]=0}var r=0,t=1,a=2,w=3,v=258,f=29,l=256,_=l+1+f,S=30,c=19,g=2*_+1,p=15,d=16,n=7,b=256,E=16,y=17,x=18,D=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],T=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],M=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],Z=512,I=new Array((_+2)*2);P(I);var G=new Array(S*2);P(G);var $=new Array(Z);P($);var Y=new Array(v-w+1);P(Y);var K=new Array(f);P(K);var H=new Array(S);P(H);function F(h,U,W,ee,L){this.static_tree=h,this.extra_bits=U,this.extra_base=W,this.elems=ee,this.max_length=L,this.has_stree=h&&h.length}var ne,J,te;function q(h,U){this.dyn_tree=h,this.max_code=0,this.stat_desc=U}function ve(h){return h<256?$[h]:$[256+(h>>>7)]}function se(h,U){h.pending_buf[h.pending++]=U&255,h.pending_buf[h.pending++]=U>>>8&255}function le(h,U,W){h.bi_valid>d-W?(h.bi_buf|=U<<h.bi_valid&65535,se(h,h.bi_buf),h.bi_buf=U>>d-h.bi_valid,h.bi_valid+=W-d):(h.bi_buf|=U<<h.bi_valid&65535,h.bi_valid+=W)}function he(h,U,W){le(h,W[U*2],W[U*2+1])}function ce(h,U){var W=0;do W|=h&1,h>>>=1,W<<=1;while(--U>0);return W>>>1}function be(h){h.bi_valid===16?(se(h,h.bi_buf),h.bi_buf=0,h.bi_valid=0):h.bi_valid>=8&&(h.pending_buf[h.pending++]=h.bi_buf&255,h.bi_buf>>=8,h.bi_valid-=8)}function Pe(h,U){var W=U.dyn_tree,ee=U.max_code,L=U.stat_desc.static_tree,O=U.stat_desc.has_stree,i=U.stat_desc.extra_bits,j=U.stat_desc.extra_base,oe=U.stat_desc.max_length,e,z,N,o,k,R,ae=0;for(o=0;o<=p;o++)h.bl_count[o]=0;for(W[h.heap[h.heap_max]*2+1]=0,e=h.heap_max+1;e<g;e++)z=h.heap[e],o=W[W[z*2+1]*2+1]+1,o>oe&&(o=oe,ae++),W[z*2+1]=o,!(z>ee)&&(h.bl_count[o]++,k=0,z>=j&&(k=i[z-j]),R=W[z*2],h.opt_len+=R*(o+k),O&&(h.static_len+=R*(L[z*2+1]+k)));if(ae!==0){do{for(o=oe-1;h.bl_count[o]===0;)o--;h.bl_count[o]--,h.bl_count[o+1]+=2,h.bl_count[oe]--,ae-=2}while(ae>0);for(o=oe;o!==0;o--)for(z=h.bl_count[o];z!==0;)N=h.heap[--e],!(N>ee)&&(W[N*2+1]!==o&&(h.opt_len+=(o-W[N*2+1])*W[N*2],W[N*2+1]=o),z--)}}function me(h,U,W){var ee=new Array(p+1),L=0,O,i;for(O=1;O<=p;O++)ee[O]=L=L+W[O-1]<<1;for(i=0;i<=U;i++){var j=h[i*2+1];j!==0&&(h[i*2]=ce(ee[j]++,j))}}function ge(){var h,U,W,ee,L,O=new Array(p+1);for(W=0,ee=0;ee<f-1;ee++)for(K[ee]=W,h=0;h<1<<D[ee];h++)Y[W++]=ee;for(Y[W-1]=ee,L=0,ee=0;ee<16;ee++)for(H[ee]=L,h=0;h<1<<T[ee];h++)$[L++]=ee;for(L>>=7;ee<S;ee++)for(H[ee]=L<<7,h=0;h<1<<T[ee]-7;h++)$[256+L++]=ee;for(U=0;U<=p;U++)O[U]=0;for(h=0;h<=143;)I[h*2+1]=8,h++,O[8]++;for(;h<=255;)I[h*2+1]=9,h++,O[9]++;for(;h<=279;)I[h*2+1]=7,h++,O[7]++;for(;h<=287;)I[h*2+1]=8,h++,O[8]++;for(me(I,_+1,O),h=0;h<S;h++)G[h*2+1]=5,G[h*2]=ce(h,5);ne=new F(I,D,l+1,_,p),J=new F(G,T,0,S,p),te=new F(new Array(0),M,0,c,n)}function Se(h){var U;for(U=0;U<_;U++)h.dyn_ltree[U*2]=0;for(U=0;U<S;U++)h.dyn_dtree[U*2]=0;for(U=0;U<c;U++)h.bl_tree[U*2]=0;h.dyn_ltree[b*2]=1,h.opt_len=h.static_len=0,h.last_lit=h.matches=0}function Ie(h){h.bi_valid>8?se(h,h.bi_buf):h.bi_valid>0&&(h.pending_buf[h.pending++]=h.bi_buf),h.bi_buf=0,h.bi_valid=0}function Ce(h,U,W,ee){Ie(h),se(h,W),se(h,~W),C.arraySet(h.pending_buf,h.window,U,W,h.pending),h.pending+=W}function de(h,U,W,ee){var L=U*2,O=W*2;return h[L]<h[O]||h[L]===h[O]&&ee[U]<=ee[W]}function V(h,U,W){for(var ee=h.heap[W],L=W<<1;L<=h.heap_len&&(L<h.heap_len&&de(U,h.heap[L+1],h.heap[L],h.depth)&&L++,!de(U,ee,h.heap[L],h.depth));)h.heap[W]=h.heap[L],W=L,L<<=1;h.heap[W]=ee}function re(h,U,W){var ee,L,O=0,i,j;if(h.last_lit!==0)do ee=h.pending_buf[h.d_buf+O*2]<<8|h.pending_buf[h.d_buf+O*2+1],L=h.pending_buf[h.l_buf+O],O++,ee===0?he(h,L,U):(i=Y[L],he(h,i+l+1,U),j=D[i],j!==0&&(L-=K[i],le(h,L,j)),ee--,i=ve(ee),he(h,i,W),j=T[i],j!==0&&(ee-=H[i],le(h,ee,j)));while(O<h.last_lit);he(h,b,U)}function fe(h,U){var W=U.dyn_tree,ee=U.stat_desc.static_tree,L=U.stat_desc.has_stree,O=U.stat_desc.elems,i,j,oe=-1,e;for(h.heap_len=0,h.heap_max=g,i=0;i<O;i++)W[i*2]!==0?(h.heap[++h.heap_len]=oe=i,h.depth[i]=0):W[i*2+1]=0;for(;h.heap_len<2;)e=h.heap[++h.heap_len]=oe<2?++oe:0,W[e*2]=1,h.depth[e]=0,h.opt_len--,L&&(h.static_len-=ee[e*2+1]);for(U.max_code=oe,i=h.heap_len>>1;i>=1;i--)V(h,W,i);e=O;do i=h.heap[1],h.heap[1]=h.heap[h.heap_len--],V(h,W,1),j=h.heap[1],h.heap[--h.heap_max]=i,h.heap[--h.heap_max]=j,W[e*2]=W[i*2]+W[j*2],h.depth[e]=(h.depth[i]>=h.depth[j]?h.depth[i]:h.depth[j])+1,W[i*2+1]=W[j*2+1]=e,h.heap[1]=e++,V(h,W,1);while(h.heap_len>=2);h.heap[--h.heap_max]=h.heap[1],Pe(h,U),me(W,oe,h.bl_count)}function pe(h,U,W){var ee,L=-1,O,i=U[1],j=0,oe=7,e=4;for(i===0&&(oe=138,e=3),U[(W+1)*2+1]=65535,ee=0;ee<=W;ee++)O=i,i=U[(ee+1)*2+1],!(++j<oe&&O===i)&&(j<e?h.bl_tree[O*2]+=j:O!==0?(O!==L&&h.bl_tree[O*2]++,h.bl_tree[E*2]++):j<=10?h.bl_tree[y*2]++:h.bl_tree[x*2]++,j=0,L=O,i===0?(oe=138,e=3):O===i?(oe=6,e=3):(oe=7,e=4))}function we(h,U,W){var ee,L=-1,O,i=U[1],j=0,oe=7,e=4;for(i===0&&(oe=138,e=3),ee=0;ee<=W;ee++)if(O=i,i=U[(ee+1)*2+1],!(++j<oe&&O===i)){if(j<e)do he(h,O,h.bl_tree);while(--j!==0);else O!==0?(O!==L&&(he(h,O,h.bl_tree),j--),he(h,E,h.bl_tree),le(h,j-3,2)):j<=10?(he(h,y,h.bl_tree),le(h,j-3,3)):(he(h,x,h.bl_tree),le(h,j-11,7));j=0,L=O,i===0?(oe=138,e=3):O===i?(oe=6,e=3):(oe=7,e=4)}}function Le(h){var U;for(pe(h,h.dyn_ltree,h.l_desc.max_code),pe(h,h.dyn_dtree,h.d_desc.max_code),fe(h,h.bl_desc),U=c-1;U>=3&&h.bl_tree[B[U]*2+1]===0;U--);return h.opt_len+=3*(U+1)+5+5+4,U}function Je(h,U,W,ee){var L;for(le(h,U-257,5),le(h,W-1,5),le(h,ee-4,4),L=0;L<ee;L++)le(h,h.bl_tree[B[L]*2+1],3);we(h,h.dyn_ltree,U-1),we(h,h.dyn_dtree,W-1)}function $e(h){var U=4093624447,W;for(W=0;W<=31;W++,U>>>=1)if(U&1&&h.dyn_ltree[W*2]!==0)return m;if(h.dyn_ltree[18]!==0||h.dyn_ltree[20]!==0||h.dyn_ltree[26]!==0)return A;for(W=32;W<l;W++)if(h.dyn_ltree[W*2]!==0)return A;return m}var Ne=!1;function Ye(h){Ne||(ge(),Ne=!0),h.l_desc=new q(h.dyn_ltree,ne),h.d_desc=new q(h.dyn_dtree,J),h.bl_desc=new q(h.bl_tree,te),h.bi_buf=0,h.bi_valid=0,Se(h)}function Ue(h,U,W,ee){le(h,(r<<1)+(ee?1:0),3),Ce(h,U,W)}function Ae(h){le(h,t<<1,3),he(h,b,I),be(h)}function He(h,U,W,ee){var L,O,i=0;h.level>0?(h.strm.data_type===u&&(h.strm.data_type=$e(h)),fe(h,h.l_desc),fe(h,h.d_desc),i=Le(h),L=h.opt_len+3+7>>>3,O=h.static_len+3+7>>>3,O<=L&&(L=O)):L=O=W+5,W+4<=L&&U!==-1?Ue(h,U,W,ee):h.strategy===s||O===L?(le(h,(t<<1)+(ee?1:0),3),re(h,I,G)):(le(h,(a<<1)+(ee?1:0),3),Je(h,h.l_desc.max_code+1,h.d_desc.max_code+1,i+1),re(h,h.dyn_ltree,h.dyn_dtree)),Se(h),ee&&Ie(h)}function qe(h,U,W){return h.pending_buf[h.d_buf+h.last_lit*2]=U>>>8&255,h.pending_buf[h.d_buf+h.last_lit*2+1]=U&255,h.pending_buf[h.l_buf+h.last_lit]=W&255,h.last_lit++,U===0?h.dyn_ltree[W*2]++:(h.matches++,U--,h.dyn_ltree[(Y[W]+l+1)*2]++,h.dyn_dtree[ve(U)*2]++),h.last_lit===h.lit_bufsize-1}return We._tr_init=Ye,We._tr_stored_block=Ue,We._tr_flush_block=He,We._tr_tally=qe,We._tr_align=Ae,We}var vt,Ct;function Jt(){if(Ct)return vt;Ct=1;function C(s,m,A,u){for(var P=s&65535|0,r=s>>>16&65535|0,t=0;A!==0;){t=A>2e3?2e3:A,A-=t;do P=P+m[u++]|0,r=r+P|0;while(--t);P%=65521,r%=65521}return P|r<<16|0}return vt=C,vt}var _t,Mt;function Yt(){if(Mt)return _t;Mt=1;function C(){for(var A,u=[],P=0;P<256;P++){A=P;for(var r=0;r<8;r++)A=A&1?3988292384^A>>>1:A>>>1;u[P]=A}return u}var s=C();function m(A,u,P,r){var t=s,a=r+P;A^=-1;for(var w=r;w<a;w++)A=A>>>8^t[(A^u[w])&255];return A^-1}return _t=m,_t}var gt,Bt;function Lt(){return Bt||(Bt=1,gt={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),gt}var Rt;function nr(){if(Rt)return Oe;Rt=1;var C=je(),s=ir(),m=Jt(),A=Yt(),u=Lt(),P=0,r=1,t=3,a=4,w=5,v=0,f=1,l=-2,_=-3,S=-5,c=-1,g=1,p=2,d=3,n=4,b=0,E=2,y=8,x=9,D=15,T=8,M=29,B=256,Z=B+1+M,I=30,G=19,$=2*Z+1,Y=15,K=3,H=258,F=H+K+1,ne=32,J=42,te=69,q=73,ve=91,se=103,le=113,he=666,ce=1,be=2,Pe=3,me=4,ge=3;function Se(e,z){return e.msg=u[z],z}function Ie(e){return(e<<1)-(e>4?9:0)}function Ce(e){for(var z=e.length;--z>=0;)e[z]=0}function de(e){var z=e.state,N=z.pending;N>e.avail_out&&(N=e.avail_out),N!==0&&(C.arraySet(e.output,z.pending_buf,z.pending_out,N,e.next_out),e.next_out+=N,z.pending_out+=N,e.total_out+=N,e.avail_out-=N,z.pending-=N,z.pending===0&&(z.pending_out=0))}function V(e,z){s._tr_flush_block(e,e.block_start>=0?e.block_start:-1,e.strstart-e.block_start,z),e.block_start=e.strstart,de(e.strm)}function re(e,z){e.pending_buf[e.pending++]=z}function fe(e,z){e.pending_buf[e.pending++]=z>>>8&255,e.pending_buf[e.pending++]=z&255}function pe(e,z,N,o){var k=e.avail_in;return k>o&&(k=o),k===0?0:(e.avail_in-=k,C.arraySet(z,e.input,e.next_in,k,N),e.state.wrap===1?e.adler=m(e.adler,z,k,N):e.state.wrap===2&&(e.adler=A(e.adler,z,k,N)),e.next_in+=k,e.total_in+=k,k)}function we(e,z){var N=e.max_chain_length,o=e.strstart,k,R,ae=e.prev_length,Q=e.nice_match,X=e.strstart>e.w_size-F?e.strstart-(e.w_size-F):0,ue=e.window,Ge=e.w_mask,Ee=e.prev,_e=e.strstart+H,ke=ue[o+ae-1],De=ue[o+ae];e.prev_length>=e.good_match&&(N>>=2),Q>e.lookahead&&(Q=e.lookahead);do if(k=z,!(ue[k+ae]!==De||ue[k+ae-1]!==ke||ue[k]!==ue[o]||ue[++k]!==ue[o+1])){o+=2,k++;do;while(ue[++o]===ue[++k]&&ue[++o]===ue[++k]&&ue[++o]===ue[++k]&&ue[++o]===ue[++k]&&ue[++o]===ue[++k]&&ue[++o]===ue[++k]&&ue[++o]===ue[++k]&&ue[++o]===ue[++k]&&o<_e);if(R=H-(_e-o),o=_e-H,R>ae){if(e.match_start=z,ae=R,R>=Q)break;ke=ue[o+ae-1],De=ue[o+ae]}}while((z=Ee[z&Ge])>X&&--N!==0);return ae<=e.lookahead?ae:e.lookahead}function Le(e){var z=e.w_size,N,o,k,R,ae;do{if(R=e.window_size-e.lookahead-e.strstart,e.strstart>=z+(z-F)){C.arraySet(e.window,e.window,z,z,0),e.match_start-=z,e.strstart-=z,e.block_start-=z,o=e.hash_size,N=o;do k=e.head[--N],e.head[N]=k>=z?k-z:0;while(--o);o=z,N=o;do k=e.prev[--N],e.prev[N]=k>=z?k-z:0;while(--o);R+=z}if(e.strm.avail_in===0)break;if(o=pe(e.strm,e.window,e.strstart+e.lookahead,R),e.lookahead+=o,e.lookahead+e.insert>=K)for(ae=e.strstart-e.insert,e.ins_h=e.window[ae],e.ins_h=(e.ins_h<<e.hash_shift^e.window[ae+1])&e.hash_mask;e.insert&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[ae+K-1])&e.hash_mask,e.prev[ae&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=ae,ae++,e.insert--,!(e.lookahead+e.insert<K)););}while(e.lookahead<F&&e.strm.avail_in!==0)}function Je(e,z){var N=65535;for(N>e.pending_buf_size-5&&(N=e.pending_buf_size-5);;){if(e.lookahead<=1){if(Le(e),e.lookahead===0&&z===P)return ce;if(e.lookahead===0)break}e.strstart+=e.lookahead,e.lookahead=0;var o=e.block_start+N;if((e.strstart===0||e.strstart>=o)&&(e.lookahead=e.strstart-o,e.strstart=o,V(e,!1),e.strm.avail_out===0)||e.strstart-e.block_start>=e.w_size-F&&(V(e,!1),e.strm.avail_out===0))return ce}return e.insert=0,z===a?(V(e,!0),e.strm.avail_out===0?Pe:me):(e.strstart>e.block_start&&(V(e,!1),e.strm.avail_out===0),ce)}function $e(e,z){for(var N,o;;){if(e.lookahead<F){if(Le(e),e.lookahead<F&&z===P)return ce;if(e.lookahead===0)break}if(N=0,e.lookahead>=K&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+K-1])&e.hash_mask,N=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),N!==0&&e.strstart-N<=e.w_size-F&&(e.match_length=we(e,N)),e.match_length>=K)if(o=s._tr_tally(e,e.strstart-e.match_start,e.match_length-K),e.lookahead-=e.match_length,e.match_length<=e.max_lazy_match&&e.lookahead>=K){e.match_length--;do e.strstart++,e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+K-1])&e.hash_mask,N=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart;while(--e.match_length!==0);e.strstart++}else e.strstart+=e.match_length,e.match_length=0,e.ins_h=e.window[e.strstart],e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+1])&e.hash_mask;else o=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++;if(o&&(V(e,!1),e.strm.avail_out===0))return ce}return e.insert=e.strstart<K-1?e.strstart:K-1,z===a?(V(e,!0),e.strm.avail_out===0?Pe:me):e.last_lit&&(V(e,!1),e.strm.avail_out===0)?ce:be}function Ne(e,z){for(var N,o,k;;){if(e.lookahead<F){if(Le(e),e.lookahead<F&&z===P)return ce;if(e.lookahead===0)break}if(N=0,e.lookahead>=K&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+K-1])&e.hash_mask,N=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart),e.prev_length=e.match_length,e.prev_match=e.match_start,e.match_length=K-1,N!==0&&e.prev_length<e.max_lazy_match&&e.strstart-N<=e.w_size-F&&(e.match_length=we(e,N),e.match_length<=5&&(e.strategy===g||e.match_length===K&&e.strstart-e.match_start>4096)&&(e.match_length=K-1)),e.prev_length>=K&&e.match_length<=e.prev_length){k=e.strstart+e.lookahead-K,o=s._tr_tally(e,e.strstart-1-e.prev_match,e.prev_length-K),e.lookahead-=e.prev_length-1,e.prev_length-=2;do++e.strstart<=k&&(e.ins_h=(e.ins_h<<e.hash_shift^e.window[e.strstart+K-1])&e.hash_mask,N=e.prev[e.strstart&e.w_mask]=e.head[e.ins_h],e.head[e.ins_h]=e.strstart);while(--e.prev_length!==0);if(e.match_available=0,e.match_length=K-1,e.strstart++,o&&(V(e,!1),e.strm.avail_out===0))return ce}else if(e.match_available){if(o=s._tr_tally(e,0,e.window[e.strstart-1]),o&&V(e,!1),e.strstart++,e.lookahead--,e.strm.avail_out===0)return ce}else e.match_available=1,e.strstart++,e.lookahead--}return e.match_available&&(o=s._tr_tally(e,0,e.window[e.strstart-1]),e.match_available=0),e.insert=e.strstart<K-1?e.strstart:K-1,z===a?(V(e,!0),e.strm.avail_out===0?Pe:me):e.last_lit&&(V(e,!1),e.strm.avail_out===0)?ce:be}function Ye(e,z){for(var N,o,k,R,ae=e.window;;){if(e.lookahead<=H){if(Le(e),e.lookahead<=H&&z===P)return ce;if(e.lookahead===0)break}if(e.match_length=0,e.lookahead>=K&&e.strstart>0&&(k=e.strstart-1,o=ae[k],o===ae[++k]&&o===ae[++k]&&o===ae[++k])){R=e.strstart+H;do;while(o===ae[++k]&&o===ae[++k]&&o===ae[++k]&&o===ae[++k]&&o===ae[++k]&&o===ae[++k]&&o===ae[++k]&&o===ae[++k]&&k<R);e.match_length=H-(R-k),e.match_length>e.lookahead&&(e.match_length=e.lookahead)}if(e.match_length>=K?(N=s._tr_tally(e,1,e.match_length-K),e.lookahead-=e.match_length,e.strstart+=e.match_length,e.match_length=0):(N=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++),N&&(V(e,!1),e.strm.avail_out===0))return ce}return e.insert=0,z===a?(V(e,!0),e.strm.avail_out===0?Pe:me):e.last_lit&&(V(e,!1),e.strm.avail_out===0)?ce:be}function Ue(e,z){for(var N;;){if(e.lookahead===0&&(Le(e),e.lookahead===0)){if(z===P)return ce;break}if(e.match_length=0,N=s._tr_tally(e,0,e.window[e.strstart]),e.lookahead--,e.strstart++,N&&(V(e,!1),e.strm.avail_out===0))return ce}return e.insert=0,z===a?(V(e,!0),e.strm.avail_out===0?Pe:me):e.last_lit&&(V(e,!1),e.strm.avail_out===0)?ce:be}function Ae(e,z,N,o,k){this.good_length=e,this.max_lazy=z,this.nice_length=N,this.max_chain=o,this.func=k}var He;He=[new Ae(0,0,0,0,Je),new Ae(4,4,8,4,$e),new Ae(4,5,16,8,$e),new Ae(4,6,32,32,$e),new Ae(4,4,16,16,Ne),new Ae(8,16,32,32,Ne),new Ae(8,16,128,128,Ne),new Ae(8,32,128,256,Ne),new Ae(32,128,258,1024,Ne),new Ae(32,258,258,4096,Ne)];function qe(e){e.window_size=2*e.w_size,Ce(e.head),e.max_lazy_match=He[e.level].max_lazy,e.good_match=He[e.level].good_length,e.nice_match=He[e.level].nice_length,e.max_chain_length=He[e.level].max_chain,e.strstart=0,e.block_start=0,e.lookahead=0,e.insert=0,e.match_length=e.prev_length=K-1,e.match_available=0,e.ins_h=0}function h(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=y,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new C.Buf16($*2),this.dyn_dtree=new C.Buf16((2*I+1)*2),this.bl_tree=new C.Buf16((2*G+1)*2),Ce(this.dyn_ltree),Ce(this.dyn_dtree),Ce(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new C.Buf16(Y+1),this.heap=new C.Buf16(2*Z+1),Ce(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new C.Buf16(2*Z+1),Ce(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function U(e){var z;return!e||!e.state?Se(e,l):(e.total_in=e.total_out=0,e.data_type=E,z=e.state,z.pending=0,z.pending_out=0,z.wrap<0&&(z.wrap=-z.wrap),z.status=z.wrap?J:le,e.adler=z.wrap===2?0:1,z.last_flush=P,s._tr_init(z),v)}function W(e){var z=U(e);return z===v&&qe(e.state),z}function ee(e,z){return!e||!e.state||e.state.wrap!==2?l:(e.state.gzhead=z,v)}function L(e,z,N,o,k,R){if(!e)return l;var ae=1;if(z===c&&(z=6),o<0?(ae=0,o=-o):o>15&&(ae=2,o-=16),k<1||k>x||N!==y||o<8||o>15||z<0||z>9||R<0||R>n)return Se(e,l);o===8&&(o=9);var Q=new h;return e.state=Q,Q.strm=e,Q.wrap=ae,Q.gzhead=null,Q.w_bits=o,Q.w_size=1<<Q.w_bits,Q.w_mask=Q.w_size-1,Q.hash_bits=k+7,Q.hash_size=1<<Q.hash_bits,Q.hash_mask=Q.hash_size-1,Q.hash_shift=~~((Q.hash_bits+K-1)/K),Q.window=new C.Buf8(Q.w_size*2),Q.head=new C.Buf16(Q.hash_size),Q.prev=new C.Buf16(Q.w_size),Q.lit_bufsize=1<<k+6,Q.pending_buf_size=Q.lit_bufsize*4,Q.pending_buf=new C.Buf8(Q.pending_buf_size),Q.d_buf=1*Q.lit_bufsize,Q.l_buf=3*Q.lit_bufsize,Q.level=z,Q.strategy=R,Q.method=N,W(e)}function O(e,z){return L(e,z,y,D,T,b)}function i(e,z){var N,o,k,R;if(!e||!e.state||z>w||z<0)return e?Se(e,l):l;if(o=e.state,!e.output||!e.input&&e.avail_in!==0||o.status===he&&z!==a)return Se(e,e.avail_out===0?S:l);if(o.strm=e,N=o.last_flush,o.last_flush=z,o.status===J)if(o.wrap===2)e.adler=0,re(o,31),re(o,139),re(o,8),o.gzhead?(re(o,(o.gzhead.text?1:0)+(o.gzhead.hcrc?2:0)+(o.gzhead.extra?4:0)+(o.gzhead.name?8:0)+(o.gzhead.comment?16:0)),re(o,o.gzhead.time&255),re(o,o.gzhead.time>>8&255),re(o,o.gzhead.time>>16&255),re(o,o.gzhead.time>>24&255),re(o,o.level===9?2:o.strategy>=p||o.level<2?4:0),re(o,o.gzhead.os&255),o.gzhead.extra&&o.gzhead.extra.length&&(re(o,o.gzhead.extra.length&255),re(o,o.gzhead.extra.length>>8&255)),o.gzhead.hcrc&&(e.adler=A(e.adler,o.pending_buf,o.pending,0)),o.gzindex=0,o.status=te):(re(o,0),re(o,0),re(o,0),re(o,0),re(o,0),re(o,o.level===9?2:o.strategy>=p||o.level<2?4:0),re(o,ge),o.status=le);else{var ae=y+(o.w_bits-8<<4)<<8,Q=-1;o.strategy>=p||o.level<2?Q=0:o.level<6?Q=1:o.level===6?Q=2:Q=3,ae|=Q<<6,o.strstart!==0&&(ae|=ne),ae+=31-ae%31,o.status=le,fe(o,ae),o.strstart!==0&&(fe(o,e.adler>>>16),fe(o,e.adler&65535)),e.adler=1}if(o.status===te)if(o.gzhead.extra){for(k=o.pending;o.gzindex<(o.gzhead.extra.length&65535)&&!(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>k&&(e.adler=A(e.adler,o.pending_buf,o.pending-k,k)),de(e),k=o.pending,o.pending===o.pending_buf_size));)re(o,o.gzhead.extra[o.gzindex]&255),o.gzindex++;o.gzhead.hcrc&&o.pending>k&&(e.adler=A(e.adler,o.pending_buf,o.pending-k,k)),o.gzindex===o.gzhead.extra.length&&(o.gzindex=0,o.status=q)}else o.status=q;if(o.status===q)if(o.gzhead.name){k=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>k&&(e.adler=A(e.adler,o.pending_buf,o.pending-k,k)),de(e),k=o.pending,o.pending===o.pending_buf_size)){R=1;break}o.gzindex<o.gzhead.name.length?R=o.gzhead.name.charCodeAt(o.gzindex++)&255:R=0,re(o,R)}while(R!==0);o.gzhead.hcrc&&o.pending>k&&(e.adler=A(e.adler,o.pending_buf,o.pending-k,k)),R===0&&(o.gzindex=0,o.status=ve)}else o.status=ve;if(o.status===ve)if(o.gzhead.comment){k=o.pending;do{if(o.pending===o.pending_buf_size&&(o.gzhead.hcrc&&o.pending>k&&(e.adler=A(e.adler,o.pending_buf,o.pending-k,k)),de(e),k=o.pending,o.pending===o.pending_buf_size)){R=1;break}o.gzindex<o.gzhead.comment.length?R=o.gzhead.comment.charCodeAt(o.gzindex++)&255:R=0,re(o,R)}while(R!==0);o.gzhead.hcrc&&o.pending>k&&(e.adler=A(e.adler,o.pending_buf,o.pending-k,k)),R===0&&(o.status=se)}else o.status=se;if(o.status===se&&(o.gzhead.hcrc?(o.pending+2>o.pending_buf_size&&de(e),o.pending+2<=o.pending_buf_size&&(re(o,e.adler&255),re(o,e.adler>>8&255),e.adler=0,o.status=le)):o.status=le),o.pending!==0){if(de(e),e.avail_out===0)return o.last_flush=-1,v}else if(e.avail_in===0&&Ie(z)<=Ie(N)&&z!==a)return Se(e,S);if(o.status===he&&e.avail_in!==0)return Se(e,S);if(e.avail_in!==0||o.lookahead!==0||z!==P&&o.status!==he){var X=o.strategy===p?Ue(o,z):o.strategy===d?Ye(o,z):He[o.level].func(o,z);if((X===Pe||X===me)&&(o.status=he),X===ce||X===Pe)return e.avail_out===0&&(o.last_flush=-1),v;if(X===be&&(z===r?s._tr_align(o):z!==w&&(s._tr_stored_block(o,0,0,!1),z===t&&(Ce(o.head),o.lookahead===0&&(o.strstart=0,o.block_start=0,o.insert=0))),de(e),e.avail_out===0))return o.last_flush=-1,v}return z!==a?v:o.wrap<=0?f:(o.wrap===2?(re(o,e.adler&255),re(o,e.adler>>8&255),re(o,e.adler>>16&255),re(o,e.adler>>24&255),re(o,e.total_in&255),re(o,e.total_in>>8&255),re(o,e.total_in>>16&255),re(o,e.total_in>>24&255)):(fe(o,e.adler>>>16),fe(o,e.adler&65535)),de(e),o.wrap>0&&(o.wrap=-o.wrap),o.pending!==0?v:f)}function j(e){var z;return!e||!e.state?l:(z=e.state.status,z!==J&&z!==te&&z!==q&&z!==ve&&z!==se&&z!==le&&z!==he?Se(e,l):(e.state=null,z===le?Se(e,_):v))}function oe(e,z){var N=z.length,o,k,R,ae,Q,X,ue,Ge;if(!e||!e.state||(o=e.state,ae=o.wrap,ae===2||ae===1&&o.status!==J||o.lookahead))return l;for(ae===1&&(e.adler=m(e.adler,z,N,0)),o.wrap=0,N>=o.w_size&&(ae===0&&(Ce(o.head),o.strstart=0,o.block_start=0,o.insert=0),Ge=new C.Buf8(o.w_size),C.arraySet(Ge,z,N-o.w_size,o.w_size,0),z=Ge,N=o.w_size),Q=e.avail_in,X=e.next_in,ue=e.input,e.avail_in=N,e.next_in=0,e.input=z,Le(o);o.lookahead>=K;){k=o.strstart,R=o.lookahead-(K-1);do o.ins_h=(o.ins_h<<o.hash_shift^o.window[k+K-1])&o.hash_mask,o.prev[k&o.w_mask]=o.head[o.ins_h],o.head[o.ins_h]=k,k++;while(--R);o.strstart=k,o.lookahead=K-1,Le(o)}return o.strstart+=o.lookahead,o.block_start=o.strstart,o.insert=o.lookahead,o.lookahead=0,o.match_length=o.prev_length=K-1,o.match_available=0,e.next_in=X,e.input=ue,e.avail_in=Q,o.wrap=ae,v}return Oe.deflateInit=O,Oe.deflateInit2=L,Oe.deflateReset=W,Oe.deflateResetKeep=U,Oe.deflateSetHeader=ee,Oe.deflate=i,Oe.deflateEnd=j,Oe.deflateSetDictionary=oe,Oe.deflateInfo="pako deflate (from Nodeca project)",Oe}var Ke={},zt;function qt(){if(zt)return Ke;zt=1;var C=je(),s=!0,m=!0;try{String.fromCharCode.apply(null,[0])}catch{s=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{m=!1}for(var A=new C.Buf8(256),u=0;u<256;u++)A[u]=u>=252?6:u>=248?5:u>=240?4:u>=224?3:u>=192?2:1;A[254]=A[254]=1,Ke.string2buf=function(r){var t,a,w,v,f,l=r.length,_=0;for(v=0;v<l;v++)a=r.charCodeAt(v),(a&64512)===55296&&v+1<l&&(w=r.charCodeAt(v+1),(w&64512)===56320&&(a=65536+(a-55296<<10)+(w-56320),v++)),_+=a<128?1:a<2048?2:a<65536?3:4;for(t=new C.Buf8(_),f=0,v=0;f<_;v++)a=r.charCodeAt(v),(a&64512)===55296&&v+1<l&&(w=r.charCodeAt(v+1),(w&64512)===56320&&(a=65536+(a-55296<<10)+(w-56320),v++)),a<128?t[f++]=a:a<2048?(t[f++]=192|a>>>6,t[f++]=128|a&63):a<65536?(t[f++]=224|a>>>12,t[f++]=128|a>>>6&63,t[f++]=128|a&63):(t[f++]=240|a>>>18,t[f++]=128|a>>>12&63,t[f++]=128|a>>>6&63,t[f++]=128|a&63);return t};function P(r,t){if(t<65534&&(r.subarray&&m||!r.subarray&&s))return String.fromCharCode.apply(null,C.shrinkBuf(r,t));for(var a="",w=0;w<t;w++)a+=String.fromCharCode(r[w]);return a}return Ke.buf2binstring=function(r){return P(r,r.length)},Ke.binstring2buf=function(r){for(var t=new C.Buf8(r.length),a=0,w=t.length;a<w;a++)t[a]=r.charCodeAt(a);return t},Ke.buf2string=function(r,t){var a,w,v,f,l=t||r.length,_=new Array(l*2);for(w=0,a=0;a<l;){if(v=r[a++],v<128){_[w++]=v;continue}if(f=A[v],f>4){_[w++]=65533,a+=f-1;continue}for(v&=f===2?31:f===3?15:7;f>1&&a<l;)v=v<<6|r[a++]&63,f--;if(f>1){_[w++]=65533;continue}v<65536?_[w++]=v:(v-=65536,_[w++]=55296|v>>10&1023,_[w++]=56320|v&1023)}return P(_,w)},Ke.utf8border=function(r,t){var a;for(t=t||r.length,t>r.length&&(t=r.length),a=t-1;a>=0&&(r[a]&192)===128;)a--;return a<0||a===0?t:a+A[r[a]]>t?a:t},Ke}var pt,Tt;function Qt(){if(Tt)return pt;Tt=1;function C(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return pt=C,pt}var Nt;function or(){if(Nt)return Qe;Nt=1;var C=nr(),s=je(),m=qt(),A=Lt(),u=Qt(),P=Object.prototype.toString,r=0,t=4,a=0,w=1,v=2,f=-1,l=0,_=8;function S(d){if(!(this instanceof S))return new S(d);this.options=s.assign({level:f,method:_,chunkSize:16384,windowBits:15,memLevel:8,strategy:l,to:""},d||{});var n=this.options;n.raw&&n.windowBits>0?n.windowBits=-n.windowBits:n.gzip&&n.windowBits>0&&n.windowBits<16&&(n.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var b=C.deflateInit2(this.strm,n.level,n.method,n.windowBits,n.memLevel,n.strategy);if(b!==a)throw new Error(A[b]);if(n.header&&C.deflateSetHeader(this.strm,n.header),n.dictionary){var E;if(typeof n.dictionary=="string"?E=m.string2buf(n.dictionary):P.call(n.dictionary)==="[object ArrayBuffer]"?E=new Uint8Array(n.dictionary):E=n.dictionary,b=C.deflateSetDictionary(this.strm,E),b!==a)throw new Error(A[b]);this._dict_set=!0}}S.prototype.push=function(d,n){var b=this.strm,E=this.options.chunkSize,y,x;if(this.ended)return!1;x=n===~~n?n:n===!0?t:r,typeof d=="string"?b.input=m.string2buf(d):P.call(d)==="[object ArrayBuffer]"?b.input=new Uint8Array(d):b.input=d,b.next_in=0,b.avail_in=b.input.length;do{if(b.avail_out===0&&(b.output=new s.Buf8(E),b.next_out=0,b.avail_out=E),y=C.deflate(b,x),y!==w&&y!==a)return this.onEnd(y),this.ended=!0,!1;(b.avail_out===0||b.avail_in===0&&(x===t||x===v))&&(this.options.to==="string"?this.onData(m.buf2binstring(s.shrinkBuf(b.output,b.next_out))):this.onData(s.shrinkBuf(b.output,b.next_out)))}while((b.avail_in>0||b.avail_out===0)&&y!==w);return x===t?(y=C.deflateEnd(this.strm),this.onEnd(y),this.ended=!0,y===a):(x===v&&(this.onEnd(a),b.avail_out=0),!0)},S.prototype.onData=function(d){this.chunks.push(d)},S.prototype.onEnd=function(d){d===a&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg};function c(d,n){var b=new S(n);if(b.push(d,!0),b.err)throw b.msg||A[b.err];return b.result}function g(d,n){return n=n||{},n.raw=!0,c(d,n)}function p(d,n){return n=n||{},n.gzip=!0,c(d,n)}return Qe.Deflate=S,Qe.deflate=c,Qe.deflateRaw=g,Qe.gzip=p,Qe}var Ve={},ze={},wt,Ot;function sr(){if(Ot)return wt;Ot=1;var C=30,s=12;return wt=function(A,u){var P,r,t,a,w,v,f,l,_,S,c,g,p,d,n,b,E,y,x,D,T,M,B,Z,I;P=A.state,r=A.next_in,Z=A.input,t=r+(A.avail_in-5),a=A.next_out,I=A.output,w=a-(u-A.avail_out),v=a+(A.avail_out-257),f=P.dmax,l=P.wsize,_=P.whave,S=P.wnext,c=P.window,g=P.hold,p=P.bits,d=P.lencode,n=P.distcode,b=(1<<P.lenbits)-1,E=(1<<P.distbits)-1;e:do{p<15&&(g+=Z[r++]<<p,p+=8,g+=Z[r++]<<p,p+=8),y=d[g&b];t:for(;;){if(x=y>>>24,g>>>=x,p-=x,x=y>>>16&255,x===0)I[a++]=y&65535;else if(x&16){D=y&65535,x&=15,x&&(p<x&&(g+=Z[r++]<<p,p+=8),D+=g&(1<<x)-1,g>>>=x,p-=x),p<15&&(g+=Z[r++]<<p,p+=8,g+=Z[r++]<<p,p+=8),y=n[g&E];r:for(;;){if(x=y>>>24,g>>>=x,p-=x,x=y>>>16&255,x&16){if(T=y&65535,x&=15,p<x&&(g+=Z[r++]<<p,p+=8,p<x&&(g+=Z[r++]<<p,p+=8)),T+=g&(1<<x)-1,T>f){A.msg="invalid distance too far back",P.mode=C;break e}if(g>>>=x,p-=x,x=a-w,T>x){if(x=T-x,x>_&&P.sane){A.msg="invalid distance too far back",P.mode=C;break e}if(M=0,B=c,S===0){if(M+=l-x,x<D){D-=x;do I[a++]=c[M++];while(--x);M=a-T,B=I}}else if(S<x){if(M+=l+S-x,x-=S,x<D){D-=x;do I[a++]=c[M++];while(--x);if(M=0,S<D){x=S,D-=x;do I[a++]=c[M++];while(--x);M=a-T,B=I}}}else if(M+=S-x,x<D){D-=x;do I[a++]=c[M++];while(--x);M=a-T,B=I}for(;D>2;)I[a++]=B[M++],I[a++]=B[M++],I[a++]=B[M++],D-=3;D&&(I[a++]=B[M++],D>1&&(I[a++]=B[M++]))}else{M=a-T;do I[a++]=I[M++],I[a++]=I[M++],I[a++]=I[M++],D-=3;while(D>2);D&&(I[a++]=I[M++],D>1&&(I[a++]=I[M++]))}}else if((x&64)===0){y=n[(y&65535)+(g&(1<<x)-1)];continue r}else{A.msg="invalid distance code",P.mode=C;break e}break}}else if((x&64)===0){y=d[(y&65535)+(g&(1<<x)-1)];continue t}else if(x&32){P.mode=s;break e}else{A.msg="invalid literal/length code",P.mode=C;break e}break}}while(r<t&&a<v);D=p>>3,r-=D,p-=D<<3,g&=(1<<p)-1,A.next_in=r,A.next_out=a,A.avail_in=r<t?5+(t-r):5-(r-t),A.avail_out=a<v?257+(v-a):257-(a-v),P.hold=g,P.bits=p},wt}var bt,It;function lr(){if(It)return bt;It=1;var C=je(),s=15,m=852,A=592,u=0,P=1,r=2,t=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],w=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],v=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return bt=function(l,_,S,c,g,p,d,n){var b=n.bits,E=0,y=0,x=0,D=0,T=0,M=0,B=0,Z=0,I=0,G=0,$,Y,K,H,F,ne=null,J=0,te,q=new C.Buf16(s+1),ve=new C.Buf16(s+1),se=null,le=0,he,ce,be;for(E=0;E<=s;E++)q[E]=0;for(y=0;y<c;y++)q[_[S+y]]++;for(T=b,D=s;D>=1&&q[D]===0;D--);if(T>D&&(T=D),D===0)return g[p++]=1<<24|64<<16|0,g[p++]=1<<24|64<<16|0,n.bits=1,0;for(x=1;x<D&&q[x]===0;x++);for(T<x&&(T=x),Z=1,E=1;E<=s;E++)if(Z<<=1,Z-=q[E],Z<0)return-1;if(Z>0&&(l===u||D!==1))return-1;for(ve[1]=0,E=1;E<s;E++)ve[E+1]=ve[E]+q[E];for(y=0;y<c;y++)_[S+y]!==0&&(d[ve[_[S+y]]++]=y);if(l===u?(ne=se=d,te=19):l===P?(ne=t,J-=257,se=a,le-=257,te=256):(ne=w,se=v,te=-1),G=0,y=0,E=x,F=p,M=T,B=0,K=-1,I=1<<T,H=I-1,l===P&&I>m||l===r&&I>A)return 1;for(;;){he=E-B,d[y]<te?(ce=0,be=d[y]):d[y]>te?(ce=se[le+d[y]],be=ne[J+d[y]]):(ce=96,be=0),$=1<<E-B,Y=1<<M,x=Y;do Y-=$,g[F+(G>>B)+Y]=he<<24|ce<<16|be|0;while(Y!==0);for($=1<<E-1;G&$;)$>>=1;if($!==0?(G&=$-1,G+=$):G=0,y++,--q[E]===0){if(E===D)break;E=_[S+d[y]]}if(E>T&&(G&H)!==K){for(B===0&&(B=T),F+=x,M=E-B,Z=1<<M;M+B<D&&(Z-=q[M+B],!(Z<=0));)M++,Z<<=1;if(I+=1<<M,l===P&&I>m||l===r&&I>A)return 1;K=G&H,g[K]=T<<24|M<<16|F-p|0}}return G!==0&&(g[F+G]=E-B<<24|64<<16|0),n.bits=T,0},bt}var Ht;function hr(){if(Ht)return ze;Ht=1;var C=je(),s=Jt(),m=Yt(),A=sr(),u=lr(),P=0,r=1,t=2,a=4,w=5,v=6,f=0,l=1,_=2,S=-2,c=-3,g=-4,p=-5,d=8,n=1,b=2,E=3,y=4,x=5,D=6,T=7,M=8,B=9,Z=10,I=11,G=12,$=13,Y=14,K=15,H=16,F=17,ne=18,J=19,te=20,q=21,ve=22,se=23,le=24,he=25,ce=26,be=27,Pe=28,me=29,ge=30,Se=31,Ie=32,Ce=852,de=592,V=15,re=V;function fe(L){return(L>>>24&255)+(L>>>8&65280)+((L&65280)<<8)+((L&255)<<24)}function pe(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new C.Buf16(320),this.work=new C.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function we(L){var O;return!L||!L.state?S:(O=L.state,L.total_in=L.total_out=O.total=0,L.msg="",O.wrap&&(L.adler=O.wrap&1),O.mode=n,O.last=0,O.havedict=0,O.dmax=32768,O.head=null,O.hold=0,O.bits=0,O.lencode=O.lendyn=new C.Buf32(Ce),O.distcode=O.distdyn=new C.Buf32(de),O.sane=1,O.back=-1,f)}function Le(L){var O;return!L||!L.state?S:(O=L.state,O.wsize=0,O.whave=0,O.wnext=0,we(L))}function Je(L,O){var i,j;return!L||!L.state||(j=L.state,O<0?(i=0,O=-O):(i=(O>>4)+1,O<48&&(O&=15)),O&&(O<8||O>15))?S:(j.window!==null&&j.wbits!==O&&(j.window=null),j.wrap=i,j.wbits=O,Le(L))}function $e(L,O){var i,j;return L?(j=new pe,L.state=j,j.window=null,i=Je(L,O),i!==f&&(L.state=null),i):S}function Ne(L){return $e(L,re)}var Ye=!0,Ue,Ae;function He(L){if(Ye){var O;for(Ue=new C.Buf32(512),Ae=new C.Buf32(32),O=0;O<144;)L.lens[O++]=8;for(;O<256;)L.lens[O++]=9;for(;O<280;)L.lens[O++]=7;for(;O<288;)L.lens[O++]=8;for(u(r,L.lens,0,288,Ue,0,L.work,{bits:9}),O=0;O<32;)L.lens[O++]=5;u(t,L.lens,0,32,Ae,0,L.work,{bits:5}),Ye=!1}L.lencode=Ue,L.lenbits=9,L.distcode=Ae,L.distbits=5}function qe(L,O,i,j){var oe,e=L.state;return e.window===null&&(e.wsize=1<<e.wbits,e.wnext=0,e.whave=0,e.window=new C.Buf8(e.wsize)),j>=e.wsize?(C.arraySet(e.window,O,i-e.wsize,e.wsize,0),e.wnext=0,e.whave=e.wsize):(oe=e.wsize-e.wnext,oe>j&&(oe=j),C.arraySet(e.window,O,i-j,oe,e.wnext),j-=oe,j?(C.arraySet(e.window,O,i-j,j,0),e.wnext=j,e.whave=e.wsize):(e.wnext+=oe,e.wnext===e.wsize&&(e.wnext=0),e.whave<e.wsize&&(e.whave+=oe))),0}function h(L,O){var i,j,oe,e,z,N,o,k,R,ae,Q,X,ue,Ge,Ee=0,_e,ke,De,Me,ot,st,ye,Re,xe=new C.Buf8(4),Ze,Fe,At=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!L||!L.state||!L.output||!L.input&&L.avail_in!==0)return S;i=L.state,i.mode===G&&(i.mode=$),z=L.next_out,oe=L.output,o=L.avail_out,e=L.next_in,j=L.input,N=L.avail_in,k=i.hold,R=i.bits,ae=N,Q=o,Re=f;e:for(;;)switch(i.mode){case n:if(i.wrap===0){i.mode=$;break}for(;R<16;){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}if(i.wrap&2&&k===35615){i.check=0,xe[0]=k&255,xe[1]=k>>>8&255,i.check=m(i.check,xe,2,0),k=0,R=0,i.mode=b;break}if(i.flags=0,i.head&&(i.head.done=!1),!(i.wrap&1)||(((k&255)<<8)+(k>>8))%31){L.msg="incorrect header check",i.mode=ge;break}if((k&15)!==d){L.msg="unknown compression method",i.mode=ge;break}if(k>>>=4,R-=4,ye=(k&15)+8,i.wbits===0)i.wbits=ye;else if(ye>i.wbits){L.msg="invalid window size",i.mode=ge;break}i.dmax=1<<ye,L.adler=i.check=1,i.mode=k&512?Z:G,k=0,R=0;break;case b:for(;R<16;){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}if(i.flags=k,(i.flags&255)!==d){L.msg="unknown compression method",i.mode=ge;break}if(i.flags&57344){L.msg="unknown header flags set",i.mode=ge;break}i.head&&(i.head.text=k>>8&1),i.flags&512&&(xe[0]=k&255,xe[1]=k>>>8&255,i.check=m(i.check,xe,2,0)),k=0,R=0,i.mode=E;case E:for(;R<32;){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}i.head&&(i.head.time=k),i.flags&512&&(xe[0]=k&255,xe[1]=k>>>8&255,xe[2]=k>>>16&255,xe[3]=k>>>24&255,i.check=m(i.check,xe,4,0)),k=0,R=0,i.mode=y;case y:for(;R<16;){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}i.head&&(i.head.xflags=k&255,i.head.os=k>>8),i.flags&512&&(xe[0]=k&255,xe[1]=k>>>8&255,i.check=m(i.check,xe,2,0)),k=0,R=0,i.mode=x;case x:if(i.flags&1024){for(;R<16;){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}i.length=k,i.head&&(i.head.extra_len=k),i.flags&512&&(xe[0]=k&255,xe[1]=k>>>8&255,i.check=m(i.check,xe,2,0)),k=0,R=0}else i.head&&(i.head.extra=null);i.mode=D;case D:if(i.flags&1024&&(X=i.length,X>N&&(X=N),X&&(i.head&&(ye=i.head.extra_len-i.length,i.head.extra||(i.head.extra=new Array(i.head.extra_len)),C.arraySet(i.head.extra,j,e,X,ye)),i.flags&512&&(i.check=m(i.check,j,X,e)),N-=X,e+=X,i.length-=X),i.length))break e;i.length=0,i.mode=T;case T:if(i.flags&2048){if(N===0)break e;X=0;do ye=j[e+X++],i.head&&ye&&i.length<65536&&(i.head.name+=String.fromCharCode(ye));while(ye&&X<N);if(i.flags&512&&(i.check=m(i.check,j,X,e)),N-=X,e+=X,ye)break e}else i.head&&(i.head.name=null);i.length=0,i.mode=M;case M:if(i.flags&4096){if(N===0)break e;X=0;do ye=j[e+X++],i.head&&ye&&i.length<65536&&(i.head.comment+=String.fromCharCode(ye));while(ye&&X<N);if(i.flags&512&&(i.check=m(i.check,j,X,e)),N-=X,e+=X,ye)break e}else i.head&&(i.head.comment=null);i.mode=B;case B:if(i.flags&512){for(;R<16;){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}if(k!==(i.check&65535)){L.msg="header crc mismatch",i.mode=ge;break}k=0,R=0}i.head&&(i.head.hcrc=i.flags>>9&1,i.head.done=!0),L.adler=i.check=0,i.mode=G;break;case Z:for(;R<32;){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}L.adler=i.check=fe(k),k=0,R=0,i.mode=I;case I:if(i.havedict===0)return L.next_out=z,L.avail_out=o,L.next_in=e,L.avail_in=N,i.hold=k,i.bits=R,_;L.adler=i.check=1,i.mode=G;case G:if(O===w||O===v)break e;case $:if(i.last){k>>>=R&7,R-=R&7,i.mode=be;break}for(;R<3;){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}switch(i.last=k&1,k>>>=1,R-=1,k&3){case 0:i.mode=Y;break;case 1:if(He(i),i.mode=te,O===v){k>>>=2,R-=2;break e}break;case 2:i.mode=F;break;case 3:L.msg="invalid block type",i.mode=ge}k>>>=2,R-=2;break;case Y:for(k>>>=R&7,R-=R&7;R<32;){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}if((k&65535)!==(k>>>16^65535)){L.msg="invalid stored block lengths",i.mode=ge;break}if(i.length=k&65535,k=0,R=0,i.mode=K,O===v)break e;case K:i.mode=H;case H:if(X=i.length,X){if(X>N&&(X=N),X>o&&(X=o),X===0)break e;C.arraySet(oe,j,e,X,z),N-=X,e+=X,o-=X,z+=X,i.length-=X;break}i.mode=G;break;case F:for(;R<14;){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}if(i.nlen=(k&31)+257,k>>>=5,R-=5,i.ndist=(k&31)+1,k>>>=5,R-=5,i.ncode=(k&15)+4,k>>>=4,R-=4,i.nlen>286||i.ndist>30){L.msg="too many length or distance symbols",i.mode=ge;break}i.have=0,i.mode=ne;case ne:for(;i.have<i.ncode;){for(;R<3;){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}i.lens[At[i.have++]]=k&7,k>>>=3,R-=3}for(;i.have<19;)i.lens[At[i.have++]]=0;if(i.lencode=i.lendyn,i.lenbits=7,Ze={bits:i.lenbits},Re=u(P,i.lens,0,19,i.lencode,0,i.work,Ze),i.lenbits=Ze.bits,Re){L.msg="invalid code lengths set",i.mode=ge;break}i.have=0,i.mode=J;case J:for(;i.have<i.nlen+i.ndist;){for(;Ee=i.lencode[k&(1<<i.lenbits)-1],_e=Ee>>>24,ke=Ee>>>16&255,De=Ee&65535,!(_e<=R);){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}if(De<16)k>>>=_e,R-=_e,i.lens[i.have++]=De;else{if(De===16){for(Fe=_e+2;R<Fe;){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}if(k>>>=_e,R-=_e,i.have===0){L.msg="invalid bit length repeat",i.mode=ge;break}ye=i.lens[i.have-1],X=3+(k&3),k>>>=2,R-=2}else if(De===17){for(Fe=_e+3;R<Fe;){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}k>>>=_e,R-=_e,ye=0,X=3+(k&7),k>>>=3,R-=3}else{for(Fe=_e+7;R<Fe;){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}k>>>=_e,R-=_e,ye=0,X=11+(k&127),k>>>=7,R-=7}if(i.have+X>i.nlen+i.ndist){L.msg="invalid bit length repeat",i.mode=ge;break}for(;X--;)i.lens[i.have++]=ye}}if(i.mode===ge)break;if(i.lens[256]===0){L.msg="invalid code -- missing end-of-block",i.mode=ge;break}if(i.lenbits=9,Ze={bits:i.lenbits},Re=u(r,i.lens,0,i.nlen,i.lencode,0,i.work,Ze),i.lenbits=Ze.bits,Re){L.msg="invalid literal/lengths set",i.mode=ge;break}if(i.distbits=6,i.distcode=i.distdyn,Ze={bits:i.distbits},Re=u(t,i.lens,i.nlen,i.ndist,i.distcode,0,i.work,Ze),i.distbits=Ze.bits,Re){L.msg="invalid distances set",i.mode=ge;break}if(i.mode=te,O===v)break e;case te:i.mode=q;case q:if(N>=6&&o>=258){L.next_out=z,L.avail_out=o,L.next_in=e,L.avail_in=N,i.hold=k,i.bits=R,A(L,Q),z=L.next_out,oe=L.output,o=L.avail_out,e=L.next_in,j=L.input,N=L.avail_in,k=i.hold,R=i.bits,i.mode===G&&(i.back=-1);break}for(i.back=0;Ee=i.lencode[k&(1<<i.lenbits)-1],_e=Ee>>>24,ke=Ee>>>16&255,De=Ee&65535,!(_e<=R);){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}if(ke&&(ke&240)===0){for(Me=_e,ot=ke,st=De;Ee=i.lencode[st+((k&(1<<Me+ot)-1)>>Me)],_e=Ee>>>24,ke=Ee>>>16&255,De=Ee&65535,!(Me+_e<=R);){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}k>>>=Me,R-=Me,i.back+=Me}if(k>>>=_e,R-=_e,i.back+=_e,i.length=De,ke===0){i.mode=ce;break}if(ke&32){i.back=-1,i.mode=G;break}if(ke&64){L.msg="invalid literal/length code",i.mode=ge;break}i.extra=ke&15,i.mode=ve;case ve:if(i.extra){for(Fe=i.extra;R<Fe;){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}i.length+=k&(1<<i.extra)-1,k>>>=i.extra,R-=i.extra,i.back+=i.extra}i.was=i.length,i.mode=se;case se:for(;Ee=i.distcode[k&(1<<i.distbits)-1],_e=Ee>>>24,ke=Ee>>>16&255,De=Ee&65535,!(_e<=R);){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}if((ke&240)===0){for(Me=_e,ot=ke,st=De;Ee=i.distcode[st+((k&(1<<Me+ot)-1)>>Me)],_e=Ee>>>24,ke=Ee>>>16&255,De=Ee&65535,!(Me+_e<=R);){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}k>>>=Me,R-=Me,i.back+=Me}if(k>>>=_e,R-=_e,i.back+=_e,ke&64){L.msg="invalid distance code",i.mode=ge;break}i.offset=De,i.extra=ke&15,i.mode=le;case le:if(i.extra){for(Fe=i.extra;R<Fe;){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}i.offset+=k&(1<<i.extra)-1,k>>>=i.extra,R-=i.extra,i.back+=i.extra}if(i.offset>i.dmax){L.msg="invalid distance too far back",i.mode=ge;break}i.mode=he;case he:if(o===0)break e;if(X=Q-o,i.offset>X){if(X=i.offset-X,X>i.whave&&i.sane){L.msg="invalid distance too far back",i.mode=ge;break}X>i.wnext?(X-=i.wnext,ue=i.wsize-X):ue=i.wnext-X,X>i.length&&(X=i.length),Ge=i.window}else Ge=oe,ue=z-i.offset,X=i.length;X>o&&(X=o),o-=X,i.length-=X;do oe[z++]=Ge[ue++];while(--X);i.length===0&&(i.mode=q);break;case ce:if(o===0)break e;oe[z++]=i.length,o--,i.mode=q;break;case be:if(i.wrap){for(;R<32;){if(N===0)break e;N--,k|=j[e++]<<R,R+=8}if(Q-=o,L.total_out+=Q,i.total+=Q,Q&&(L.adler=i.check=i.flags?m(i.check,oe,Q,z-Q):s(i.check,oe,Q,z-Q)),Q=o,(i.flags?k:fe(k))!==i.check){L.msg="incorrect data check",i.mode=ge;break}k=0,R=0}i.mode=Pe;case Pe:if(i.wrap&&i.flags){for(;R<32;){if(N===0)break e;N--,k+=j[e++]<<R,R+=8}if(k!==(i.total&4294967295)){L.msg="incorrect length check",i.mode=ge;break}k=0,R=0}i.mode=me;case me:Re=l;break e;case ge:Re=c;break e;case Se:return g;case Ie:default:return S}return L.next_out=z,L.avail_out=o,L.next_in=e,L.avail_in=N,i.hold=k,i.bits=R,(i.wsize||Q!==L.avail_out&&i.mode<ge&&(i.mode<be||O!==a))&&qe(L,L.output,L.next_out,Q-L.avail_out),ae-=L.avail_in,Q-=L.avail_out,L.total_in+=ae,L.total_out+=Q,i.total+=Q,i.wrap&&Q&&(L.adler=i.check=i.flags?m(i.check,oe,Q,L.next_out-Q):s(i.check,oe,Q,L.next_out-Q)),L.data_type=i.bits+(i.last?64:0)+(i.mode===G?128:0)+(i.mode===te||i.mode===K?256:0),(ae===0&&Q===0||O===a)&&Re===f&&(Re=p),Re}function U(L){if(!L||!L.state)return S;var O=L.state;return O.window&&(O.window=null),L.state=null,f}function W(L,O){var i;return!L||!L.state||(i=L.state,(i.wrap&2)===0)?S:(i.head=O,O.done=!1,f)}function ee(L,O){var i=O.length,j,oe,e;return!L||!L.state||(j=L.state,j.wrap!==0&&j.mode!==I)?S:j.mode===I&&(oe=1,oe=s(oe,O,i,0),oe!==j.check)?c:(e=qe(L,O,i,i),e?(j.mode=Se,g):(j.havedict=1,f))}return ze.inflateReset=Le,ze.inflateReset2=Je,ze.inflateResetKeep=we,ze.inflateInit=Ne,ze.inflateInit2=$e,ze.inflate=h,ze.inflateEnd=U,ze.inflateGetHeader=W,ze.inflateSetDictionary=ee,ze.inflateInfo="pako inflate (from Nodeca project)",ze}var Et,Ft;function Vt(){return Ft||(Ft=1,Et={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),Et}var mt,Gt;function dr(){if(Gt)return mt;Gt=1;function C(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return mt=C,mt}var Zt;function fr(){if(Zt)return Ve;Zt=1;var C=hr(),s=je(),m=qt(),A=Vt(),u=Lt(),P=Qt(),r=dr(),t=Object.prototype.toString;function a(f){if(!(this instanceof a))return new a(f);this.options=s.assign({chunkSize:16384,windowBits:0,to:""},f||{});var l=this.options;l.raw&&l.windowBits>=0&&l.windowBits<16&&(l.windowBits=-l.windowBits,l.windowBits===0&&(l.windowBits=-15)),l.windowBits>=0&&l.windowBits<16&&!(f&&f.windowBits)&&(l.windowBits+=32),l.windowBits>15&&l.windowBits<48&&(l.windowBits&15)===0&&(l.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new P,this.strm.avail_out=0;var _=C.inflateInit2(this.strm,l.windowBits);if(_!==A.Z_OK)throw new Error(u[_]);if(this.header=new r,C.inflateGetHeader(this.strm,this.header),l.dictionary&&(typeof l.dictionary=="string"?l.dictionary=m.string2buf(l.dictionary):t.call(l.dictionary)==="[object ArrayBuffer]"&&(l.dictionary=new Uint8Array(l.dictionary)),l.raw&&(_=C.inflateSetDictionary(this.strm,l.dictionary),_!==A.Z_OK)))throw new Error(u[_])}a.prototype.push=function(f,l){var _=this.strm,S=this.options.chunkSize,c=this.options.dictionary,g,p,d,n,b,E=!1;if(this.ended)return!1;p=l===~~l?l:l===!0?A.Z_FINISH:A.Z_NO_FLUSH,typeof f=="string"?_.input=m.binstring2buf(f):t.call(f)==="[object ArrayBuffer]"?_.input=new Uint8Array(f):_.input=f,_.next_in=0,_.avail_in=_.input.length;do{if(_.avail_out===0&&(_.output=new s.Buf8(S),_.next_out=0,_.avail_out=S),g=C.inflate(_,A.Z_NO_FLUSH),g===A.Z_NEED_DICT&&c&&(g=C.inflateSetDictionary(this.strm,c)),g===A.Z_BUF_ERROR&&E===!0&&(g=A.Z_OK,E=!1),g!==A.Z_STREAM_END&&g!==A.Z_OK)return this.onEnd(g),this.ended=!0,!1;_.next_out&&(_.avail_out===0||g===A.Z_STREAM_END||_.avail_in===0&&(p===A.Z_FINISH||p===A.Z_SYNC_FLUSH))&&(this.options.to==="string"?(d=m.utf8border(_.output,_.next_out),n=_.next_out-d,b=m.buf2string(_.output,d),_.next_out=n,_.avail_out=S-n,n&&s.arraySet(_.output,_.output,d,n,0),this.onData(b)):this.onData(s.shrinkBuf(_.output,_.next_out))),_.avail_in===0&&_.avail_out===0&&(E=!0)}while((_.avail_in>0||_.avail_out===0)&&g!==A.Z_STREAM_END);return g===A.Z_STREAM_END&&(p=A.Z_FINISH),p===A.Z_FINISH?(g=C.inflateEnd(this.strm),this.onEnd(g),this.ended=!0,g===A.Z_OK):(p===A.Z_SYNC_FLUSH&&(this.onEnd(A.Z_OK),_.avail_out=0),!0)},a.prototype.onData=function(f){this.chunks.push(f)},a.prototype.onEnd=function(f){f===A.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=s.flattenChunks(this.chunks)),this.chunks=[],this.err=f,this.msg=this.strm.msg};function w(f,l){var _=new a(l);if(_.push(f,!0),_.err)throw _.msg||u[_.err];return _.result}function v(f,l){return l=l||{},l.raw=!0,w(f,l)}return Ve.Inflate=a,Ve.inflate=w,Ve.inflateRaw=v,Ve.ungzip=w,Ve}var yt,$t;function cr(){if($t)return yt;$t=1;var C=je().assign,s=or(),m=fr(),A=Vt(),u={};return C(u,s,m,A),yt=u,yt}var Ut;function ur(){return Ut||(Ut=1,function(C){(function(){var s={};C.exports=s;var m;typeof ar=="function"?m=cr():m=self.pako;function A(){typeof process>"u"&&console.log.apply(console,arguments)}(function(u,P){(function(){var r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(w){return typeof w}:function(w){return w&&typeof Symbol=="function"&&w.constructor===Symbol&&w!==Symbol.prototype?"symbol":typeof w},t=function(){function w(v){this.message="JPEG error: "+v}return w.prototype=Error(),w.prototype.name="JpegError",w.constructor=w}(),a=function(){function w(v,f){this.message=v,this.g=f}return w.prototype=Error(),w.prototype.name="DNLMarkerError",w.constructor=w}();(function(){function w(){this.M=null,this.B=-1}function v(c,g){for(var p=0,d=[],n,b,E=16;0<E&&!c[E-1];)E--;d.push({children:[],index:0});var y=d[0],x;for(n=0;n<E;n++){for(b=0;b<c[n];b++){for(y=d.pop(),y.children[y.index]=g[p];0<y.index;)y=d.pop();for(y.index++,d.push(y);d.length<=n;)d.push(x={children:[],index:0}),y.children[y.index]=x.children,y=x;p++}n+1<E&&(d.push(x={children:[],index:0}),y.children[y.index]=x.children,y=x)}return d[0].children}function f(c,g,p,d,n,b,E,y,x){function D(){if(0<J)return J--,ne>>J&1;if(ne=c[g++],ne===255){var V=c[g++];if(V){if(V===220&&K){g+=2;var re=c[g++]<<8|c[g++];if(0<re&&re!==p.g)throw new a("Found DNL marker (0xFFDC) while parsing scan data",re)}throw new t("unexpected marker "+(ne<<8|V).toString(16))}}return J=7,ne>>>7}function T(V){for(;;){if(V=V[D()],typeof V=="number")return V;if((typeof V>"u"?"undefined":r(V))!=="object")throw new t("invalid huffman sequence")}}function M(V){for(var re=0;0<V;)re=re<<1|D(),V--;return re}function B(V){if(V===1)return D()===1?1:-1;var re=M(V);return re>=1<<V-1?re:re+(-1<<V)+1}function Z(V,re){var fe=T(V.D);for(fe=fe===0?0:B(fe),V.a[re]=V.m+=fe,fe=1;64>fe;){var pe=T(V.o),we=pe&15;if(pe>>=4,we===0){if(15>pe)break;fe+=16}else fe+=pe,V.a[re+S[fe]]=B(we),fe++}}function I(V,re){var fe=T(V.D);fe=fe===0?0:B(fe)<<x,V.a[re]=V.m+=fe}function G(V,re){V.a[re]|=D()<<x}function $(V,re){if(0<te)te--;else for(var fe=b;fe<=E;){var pe=T(V.o),we=pe&15;if(pe>>=4,we===0){if(15>pe){te=M(pe)+(1<<pe)-1;break}fe+=16}else fe+=pe,V.a[re+S[fe]]=B(we)*(1<<x),fe++}}function Y(V,re){for(var fe=b,pe=0,we;fe<=E;){we=re+S[fe];var Le=0>V.a[we]?-1:1;switch(q){case 0:if(pe=T(V.o),we=pe&15,pe>>=4,we===0)15>pe?(te=M(pe)+(1<<pe),q=4):(pe=16,q=1);else{if(we!==1)throw new t("invalid ACn encoding");ve=B(we),q=pe?2:3}continue;case 1:case 2:V.a[we]?V.a[we]+=Le*(D()<<x):(pe--,pe===0&&(q=q===2?3:0));break;case 3:V.a[we]?V.a[we]+=Le*(D()<<x):(V.a[we]=ve<<x,q=0);break;case 4:V.a[we]&&(V.a[we]+=Le*(D()<<x))}fe++}q===4&&(te--,te===0&&(q=0))}for(var K=9<arguments.length&&arguments[9]!==void 0?arguments[9]:!1,H=p.P,F=g,ne=0,J=0,te=0,q=0,ve,se=d.length,le,he,ce,be,Pe=p.S?b===0?y===0?I:G:y===0?$:Y:Z,me=0,ge=se===1?d[0].c*d[0].l:H*p.O,Se,Ie;me<ge;){var Ce=n?Math.min(ge-me,n):ge;for(le=0;le<se;le++)d[le].m=0;if(te=0,se===1){var de=d[0];for(be=0;be<Ce;be++)Pe(de,64*((de.c+1)*(me/de.c|0)+me%de.c)),me++}else for(be=0;be<Ce;be++){for(le=0;le<se;le++)for(de=d[le],Se=de.h,Ie=de.j,he=0;he<Ie;he++)for(ce=0;ce<Se;ce++)Pe(de,64*((de.c+1)*((me/H|0)*de.j+he)+(me%H*de.h+ce)));me++}if(J=0,(de=_(c,g))&&de.f&&((0,_util.warn)("decodeScan - unexpected MCU data, current marker is: "+de.f),g=de.offset),de=de&&de.F,!de||65280>=de)throw new t("marker was not found");if(65488<=de&&65495>=de)g+=2;else break}return(de=_(c,g))&&de.f&&((0,_util.warn)("decodeScan - unexpected Scan data, current marker is: "+de.f),g=de.offset),g-F}function l(c,g){for(var p=g.c,d=g.l,n=new Int16Array(64),b=0;b<d;b++)for(var E=0;E<p;E++){var y=64*((g.c+1)*b+E),x=n,D=g.G,T=g.a;if(!D)throw new t("missing required Quantization Table.");for(var M=0;64>M;M+=8){var B=T[y+M],Z=T[y+M+1],I=T[y+M+2],G=T[y+M+3],$=T[y+M+4],Y=T[y+M+5],K=T[y+M+6],H=T[y+M+7];if(B*=D[M],(Z|I|G|$|Y|K|H)===0)B=5793*B+512>>10,x[M]=B,x[M+1]=B,x[M+2]=B,x[M+3]=B,x[M+4]=B,x[M+5]=B,x[M+6]=B,x[M+7]=B;else{Z*=D[M+1],I*=D[M+2],G*=D[M+3],$*=D[M+4],Y*=D[M+5],K*=D[M+6],H*=D[M+7];var F=5793*B+128>>8,ne=5793*$+128>>8,J=I,te=K;$=2896*(Z-H)+128>>8,H=2896*(Z+H)+128>>8,G<<=4,Y<<=4,F=F+ne+1>>1,ne=F-ne,B=3784*J+1567*te+128>>8,J=1567*J-3784*te+128>>8,te=B,$=$+Y+1>>1,Y=$-Y,H=H+G+1>>1,G=H-G,F=F+te+1>>1,te=F-te,ne=ne+J+1>>1,J=ne-J,B=2276*$+3406*H+2048>>12,$=3406*$-2276*H+2048>>12,H=B,B=799*G+4017*Y+2048>>12,G=4017*G-799*Y+2048>>12,Y=B,x[M]=F+H,x[M+7]=F-H,x[M+1]=ne+Y,x[M+6]=ne-Y,x[M+2]=J+G,x[M+5]=J-G,x[M+3]=te+$,x[M+4]=te-$}}for(D=0;8>D;++D)B=x[D],Z=x[D+8],I=x[D+16],G=x[D+24],$=x[D+32],Y=x[D+40],K=x[D+48],H=x[D+56],(Z|I|G|$|Y|K|H)===0?(B=5793*B+8192>>14,B=-2040>B?0:2024<=B?255:B+2056>>4,T[y+D]=B,T[y+D+8]=B,T[y+D+16]=B,T[y+D+24]=B,T[y+D+32]=B,T[y+D+40]=B,T[y+D+48]=B,T[y+D+56]=B):(F=5793*B+2048>>12,ne=5793*$+2048>>12,J=I,te=K,$=2896*(Z-H)+2048>>12,H=2896*(Z+H)+2048>>12,F=(F+ne+1>>1)+4112,ne=F-ne,B=3784*J+1567*te+2048>>12,J=1567*J-3784*te+2048>>12,te=B,$=$+Y+1>>1,Y=$-Y,H=H+G+1>>1,G=H-G,F=F+te+1>>1,te=F-te,ne=ne+J+1>>1,J=ne-J,B=2276*$+3406*H+2048>>12,$=3406*$-2276*H+2048>>12,H=B,B=799*G+4017*Y+2048>>12,G=4017*G-799*Y+2048>>12,Y=B,B=F+H,H=F-H,Z=ne+Y,K=ne-Y,I=J+G,Y=J-G,G=te+$,$=te-$,B=16>B?0:4080<=B?255:B>>4,Z=16>Z?0:4080<=Z?255:Z>>4,I=16>I?0:4080<=I?255:I>>4,G=16>G?0:4080<=G?255:G>>4,$=16>$?0:4080<=$?255:$>>4,Y=16>Y?0:4080<=Y?255:Y>>4,K=16>K?0:4080<=K?255:K>>4,H=16>H?0:4080<=H?255:H>>4,T[y+D]=B,T[y+D+8]=Z,T[y+D+16]=I,T[y+D+24]=G,T[y+D+32]=$,T[y+D+40]=Y,T[y+D+48]=K,T[y+D+56]=H)}return g.a}function _(c,g){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:g,d=c.length-1;if(p=p<g?p:g,g>=d)return null;var n=c[g]<<8|c[g+1];if(65472<=n&&65534>=n)return{f:null,F:n,offset:g};for(var b=c[p]<<8|c[p+1];!(65472<=b&&65534>=b);){if(++p>=d)return null;b=c[p]<<8|c[p+1]}return{f:n.toString(16),F:b,offset:p}}var S=new Uint8Array([0,1,8,16,9,2,3,10,17,24,32,25,18,11,4,5,12,19,26,33,40,48,41,34,27,20,13,6,7,14,21,28,35,42,49,56,57,50,43,36,29,22,15,23,30,37,44,51,58,59,52,45,38,31,39,46,53,60,61,54,47,55,62,63]);w.prototype={parse:function(c){function g(){var J=c[E]<<8|c[E+1];return E+=2,J}function p(){var J=g();J=E+J-2;var te=_(c,J,E);return te&&te.f&&((0,_util.warn)("readDataBlock - incorrect length, current marker is: "+te.f),J=te.offset),J=c.subarray(E,J),E+=J.length,J}function d(J){for(var te=Math.ceil(J.v/8/J.s),q=Math.ceil(J.g/8/J.u),ve=0;ve<J.b.length;ve++){F=J.b[ve];var se=Math.ceil(Math.ceil(J.v/8)*F.h/J.s),le=Math.ceil(Math.ceil(J.g/8)*F.j/J.u);F.a=new Int16Array(64*q*F.j*(te*F.h+1)),F.c=se,F.l=le}J.P=te,J.O=q}var n=(1<arguments.length&&arguments[1]!==void 0?arguments[1]:{}).N,b=n===void 0?null:n,E=0,y=null,x=0;n=[];var D=[],T=[],M=g();if(M!==65496)throw new t("SOI not found");for(M=g();M!==65497;){switch(M){case 65504:case 65505:case 65506:case 65507:case 65508:case 65509:case 65510:case 65511:case 65512:case 65513:case 65514:case 65515:case 65516:case 65517:case 65518:case 65519:case 65534:var B=p();M===65518&&B[0]===65&&B[1]===100&&B[2]===111&&B[3]===98&&B[4]===101&&(y={version:B[5]<<8|B[6],Y:B[7]<<8|B[8],Z:B[9]<<8|B[10],W:B[11]});break;case 65499:M=g()+E-2;for(var Z;E<M;){var I=c[E++],G=new Uint16Array(64);if(I>>4===0)for(B=0;64>B;B++)Z=S[B],G[Z]=c[E++];else if(I>>4===1)for(B=0;64>B;B++)Z=S[B],G[Z]=g();else throw new t("DQT - invalid table spec");n[I&15]=G}break;case 65472:case 65473:case 65474:if($)throw new t("Only single frame JPEGs supported");g();var $={};for($.X=M===65473,$.S=M===65474,$.precision=c[E++],M=g(),$.g=b||M,$.v=g(),$.b=[],$.C={},B=c[E++],M=G=I=0;M<B;M++){Z=c[E];var Y=c[E+1]>>4,K=c[E+1]&15;I<Y&&(I=Y),G<K&&(G=K),Y=$.b.push({h:Y,j:K,T:c[E+2],G:null}),$.C[Z]=Y-1,E+=3}$.s=I,$.u=G,d($);break;case 65476:for(Z=g(),M=2;M<Z;){for(I=c[E++],G=new Uint8Array(16),B=Y=0;16>B;B++,E++)Y+=G[B]=c[E];for(K=new Uint8Array(Y),B=0;B<Y;B++,E++)K[B]=c[E];M+=17+Y,(I>>4===0?T:D)[I&15]=v(G,K)}break;case 65501:g();var H=g();break;case 65498:for(B=++x===1&&!b,g(),I=c[E++],Z=[],M=0;M<I;M++){G=$.C[c[E++]];var F=$.b[G];G=c[E++],F.D=T[G>>4],F.o=D[G&15],Z.push(F)}M=c[E++],I=c[E++],G=c[E++];try{var ne=f(c,E,$,Z,H,M,I,G>>4,G&15,B);E+=ne}catch(J){if(J instanceof a)return(0,_util.warn)('Attempting to re-parse JPEG image using "scanLines" parameter found in DNL marker (0xFFDC) segment.'),this.parse(c,{N:J.g});throw J}break;case 65500:E+=4;break;case 65535:c[E]!==255&&E--;break;default:if(c[E-3]===255&&192<=c[E-2]&&254>=c[E-2])E-=3;else if((B=_(c,E-2))&&B.f)(0,_util.warn)("JpegImage.parse - unexpected data, current marker is: "+B.f),E=B.offset;else throw new t("unknown marker "+M.toString(16))}M=g()}for(this.width=$.v,this.height=$.g,this.A=y,this.b=[],M=0;M<$.b.length;M++)F=$.b[M],(H=n[F.T])&&(F.G=H),this.b.push({R:l($,F),U:F.h/$.s,V:F.j/$.u,c:F.c,l:F.l});this.i=this.b.length},L:function(c,g){var p=this.width/c,d=this.height/g,n,b,E=this.b.length,y=c*g*E,x=new Uint8ClampedArray(y),D=new Uint32Array(c);for(b=0;b<E;b++){var T=this.b[b],M=T.U*p,B=T.V*d,Z=b,I=T.R,G=T.c+1<<3;for(n=0;n<c;n++)T=0|n*M,D[n]=(T&4294967288)<<3|T&7;for(M=0;M<g;M++)for(T=0|M*B,T=G*(T&4294967288)|(T&7)<<3,n=0;n<c;n++)x[Z]=I[T+D[n]],Z+=E}if(d=this.M)for(b=0;b<y;)for(p=T=0;T<E;T++,b++,p+=2)x[b]=(x[b]*d[p]>>8)+d[p+1];return x},w:function(){return this.A?!!this.A.W:this.i===3?this.B!==0:this.B===1},I:function(c){for(var g,p,d,n=0,b=c.length;n<b;n+=3)g=c[n],p=c[n+1],d=c[n+2],c[n]=g-179.456+1.402*d,c[n+1]=g+135.459-.344*p-.714*d,c[n+2]=g-226.816+1.772*p;return c},K:function(c){for(var g,p,d,n,b=0,E=0,y=c.length;E<y;E+=4)g=c[E],p=c[E+1],d=c[E+2],n=c[E+3],c[b++]=-122.67195406894+p*(-660635669420364e-19*p+.000437130475926232*d-54080610064599e-18*g+.00048449797120281*n-.154362151871126)+d*(-.000957964378445773*d+.000817076911346625*g-.00477271405408747*n+1.53380253221734)+g*(.000961250184130688*g-.00266257332283933*n+.48357088451265)+n*(-.000336197177618394*n+.484791561490776),c[b++]=107.268039397724+p*(219927104525741e-19*p-.000640992018297945*d+.000659397001245577*g+.000426105652938837*n-.176491792462875)+d*(-.000778269941513683*d+.00130872261408275*g+.000770482631801132*n-.151051492775562)+g*(.00126935368114843*g-.00265090189010898*n+.25802910206845)+n*(-.000318913117588328*n-.213742400323665),c[b++]=-20.810012546947+p*(-.000570115196973677*p-263409051004589e-19*d+.0020741088115012*g-.00288260236853442*n+.814272968359295)+d*(-153496057440975e-19*d-.000132689043961446*g+.000560833691242812*n-.195152027534049)+g*(.00174418132927582*g-.00255243321439347*n+.116935020465145)+n*(-.000343531996510555*n+.24165260232407);return c.subarray(0,b)},J:function(c){for(var g,p,d,n=0,b=c.length;n<b;n+=4)g=c[n],p=c[n+1],d=c[n+2],c[n]=434.456-g-1.402*d,c[n+1]=119.541-g+.344*p+.714*d,c[n+2]=481.816-g-1.772*p;return c},H:function(c){for(var g,p,d,n,b=0,E=1/255,y=0,x=c.length;y<x;y+=4)g=c[y]*E,p=c[y+1]*E,d=c[y+2]*E,n=c[y+3]*E,c[b++]=255+g*(-4.387332384609988*g+54.48615194189176*p+18.82290502165302*d+212.25662451639585*n-285.2331026137004)+p*(1.7149763477362134*p-5.6096736904047315*d-17.873870861415444*n-5.497006427196366)+d*(-2.5217340131683033*d-21.248923337353073*n+17.5119270841813)-n*(21.86122147463605*n+189.48180835922747),c[b++]=255+g*(8.841041422036149*g+60.118027045597366*p+6.871425592049007*d+31.159100130055922*n-79.2970844816548)+p*(-15.310361306967817*p+17.575251261109482*d+131.35250912493976*n-190.9453302588951)+d*(4.444339102852739*d+9.8632861493405*n-24.86741582555878)-n*(20.737325471181034*n+187.80453709719578),c[b++]=255+g*(.8842522430003296*g+8.078677503112928*p+30.89978309703729*d-.23883238689178934*n-14.183576799673286)+p*(10.49593273432072*p+63.02378494754052*d+50.606957656360734*n-112.23884253719248)+d*(.03296041114873217*d+115.60384449646641*n-193.58209356861505)-n*(22.33816807309886*n+180.12613974708367);return c.subarray(0,b)},getData:function(c,g,p){if(4<this.i)throw new t("Unsupported color mode");if(c=this.L(c,g),this.i===1&&p){p=c.length,g=new Uint8ClampedArray(3*p);for(var d=0,n=0;n<p;n++){var b=c[n];g[d++]=b,g[d++]=b,g[d++]=b}return g}if(this.i===3&&this.w())return this.I(c);if(this.i===4){if(this.w())return p?this.K(c):this.J(c);if(p)return this.H(c)}return c}},u.JpegDecoder=w})()})(),u.encodeImage=function(r,t,a,w){var v={t256:[t],t257:[a],t258:[8,8,8,8],t259:[1],t262:[2],t273:[1e3],t277:[4],t278:[a],t279:[t*a*4],t282:[1],t283:[1],t284:[1],t286:[0],t287:[0],t296:[1],t305:["Photopea (UTIF.js)"],t338:[1]};if(w)for(var f in w)v[f]=w[f];for(var l=new Uint8Array(u.encode([v])),_=new Uint8Array(r),S=new Uint8Array(1e3+t*a*4),f=0;f<l.length;f++)S[f]=l[f];for(var f=0;f<_.length;f++)S[1e3+f]=_[f];return S.buffer},u.encode=function(r){var t=new Uint8Array(2e4),a=4,w=u._binBE;t[0]=77,t[1]=77,t[3]=42;var v=8;w.writeUint(t,a,v),a+=4;for(var f=0;f<r.length;f++){var l=u._writeIFD(w,t,v,r[f]);v=l[1],f<r.length-1&&w.writeUint(t,l[0],v)}return t.slice(0,v).buffer},u.decode=function(r){u.decode._decodeG3.allow2D=null;var t=new Uint8Array(r),a=0,w=u._binBE.readASCII(t,a,2);a+=2;var v=w=="II"?u._binLE:u._binBE;v.readUshort(t,a),a+=2;var f=v.readUint(t,a);a+=4;for(var l=[];;){var _=u._readIFD(v,t,f,l,0,!1);if(f=v.readUint(t,_),f==0)break}return l},u.decodeImage=function(r,t,a){var w=new Uint8Array(r),v=u._binBE.readASCII(w,0,2);if(t.t256!=null){t.isLE=v=="II",t.width=t.t256[0],t.height=t.t257[0];var f=t.t259?t.t259[0]:1,l=t.t266?t.t266[0]:1;t.t284&&t.t284[0]==2&&A("PlanarConfiguration 2 should not be used!");var _;t.t258?_=Math.min(32,t.t258[0])*t.t258.length:_=t.t277?t.t277[0]:1,f==1&&t.t279!=null&&t.t278&&t.t262[0]==32803&&(_=Math.round(t.t279[0]*8/(t.width*t.t278[0])));var S=Math.ceil(t.width*_/8)*8,c=t.t273;c==null&&(c=t.t324);var g=t.t279;f==1&&c.length==1&&(g=[t.height*(S>>>3)]),g==null&&(g=t.t325);var p=new Uint8Array(t.height*(S>>>3)),d=0;if(t.t322!=null){for(var n=t.t322[0],b=t.t323[0],E=Math.floor((t.width+n-1)/n),y=Math.floor((t.height+b-1)/b),x=new Uint8Array(Math.ceil(n*b*_/8)|0),D=0;D<y;D++)for(var T=0;T<E;T++){for(var M=D*E+T,B=0;B<x.length;B++)x[B]=0;u.decode._decompress(t,a,w,c[M],g[M],f,x,0,l),f==6?p=x:u._copyTile(x,Math.ceil(n*_/8)|0,b,p,Math.ceil(t.width*_/8)|0,t.height,Math.ceil(T*n*_/8)|0,D*b)}d=p.length*8}else{var Z=t.t278?t.t278[0]:t.height;Z=Math.min(Z,t.height);for(var M=0;M<c.length;M++)u.decode._decompress(t,a,w,c[M],g[M],f,p,Math.ceil(d/8)|0,l),d+=S*Z;d=Math.min(d,p.length*8)}t.data=new Uint8Array(p.buffer,0,Math.ceil(d/8)|0)}},u.decode._decompress=function(r,t,a,w,v,f,l,_,S){if(f==1||v==l.length&&f!=32767)for(var c=0;c<v;c++)l[_+c]=a[w+c];else if(f==3)u.decode._decodeG3(a,w,v,l,_,r.width,S);else if(f==4)u.decode._decodeG4(a,w,v,l,_,r.width,S);else if(f==5)u.decode._decodeLZW(a,w,l,_);else if(f==6)u.decode._decodeOldJPEG(r,a,w,v,l,_);else if(f==7)u.decode._decodeNewJPEG(r,a,w,v,l,_);else if(f==8)for(var g=new Uint8Array(a.buffer,w,v),p=P.inflate(g),d=0;d<p.length;d++)l[_+d]=p[d];else f==32767?u.decode._decodeARW(r,a,w,v,l,_):f==32773?u.decode._decodePackBits(a,w,v,l,_):f==32809?u.decode._decodeThunder(a,w,v,l,_):f==34713?u.decode._decodeNikon(r,t,a,w,v,l,_):A("Unknown compression",f);var n=r.t258?Math.min(32,r.t258[0]):1,b=r.t277?r.t277[0]:1,E=n*b>>>3,y=r.t278?r.t278[0]:r.height,x=Math.ceil(n*b*r.width/8);if(n==16&&!r.isLE&&r.t33422==null)for(var D=0;D<y;D++)for(var T=_+D*x,M=1;M<x;M+=2){var B=l[T+M];l[T+M]=l[T+M-1],l[T+M-1]=B}if(r.t317&&r.t317[0]==2)for(var D=0;D<y;D++){var Z=_+D*x;if(n==16)for(var c=E;c<x;c+=2){var I=(l[Z+c+1]<<8|l[Z+c])+(l[Z+c-E+1]<<8|l[Z+c-E]);l[Z+c]=I&255,l[Z+c+1]=I>>>8&255}else if(b==3)for(var c=3;c<x;c+=3)l[Z+c]=l[Z+c]+l[Z+c-3]&255,l[Z+c+1]=l[Z+c+1]+l[Z+c-2]&255,l[Z+c+2]=l[Z+c+2]+l[Z+c-1]&255;else for(var c=E;c<x;c++)l[Z+c]=l[Z+c]+l[Z+c-E]&255}},u.decode._ljpeg_diff=function(r,t,a){var w=u.decode._getbithuff,v,f;return v=w(r,t,a[0],a),f=w(r,t,v,0),(f&1<<v-1)==0&&(f-=(1<<v)-1),f},u.decode._decodeARW=function(r,t,a,w,v,f){var l=r.t256[0],_=r.t257[0],S=r.t258[0],c=r.isLE?u._binLE:u._binBE,g=l*_==w||l*_*1.5==w;if(!g){_+=8;var p=[a,0,0,0],d=new Uint16Array(32770),n=[3857,3856,3599,3342,3085,2828,2571,2314,2057,1800,1543,1286,1029,772,771,768,514,513],q,b,E,$,G,y=0,x=u.decode._ljpeg_diff;for(d[0]=15,E=q=0;q<18;q++)for(var D=32768>>>(n[q]>>>8),b=0;b<D;b++)d[++E]=n[q];for($=l;$--;)for(G=0;G<_+1;G+=2)if(G==_&&(G=1),y+=x(t,p,d),G<_){var T=y&4095;u.decode._putsF(v,(G*l+$)*S,T<<16-S)}return}if(l*_*1.5==w){for(var q=0;q<w;q+=3){var M=t[a+q+0],B=t[a+q+1],Z=t[a+q+2];v[f+q]=B<<4|M>>>4,v[f+q+1]=M<<4|Z>>>4,v[f+q+2]=Z<<4|B>>>4}return}var I=new Uint16Array(16),G,$,Y,K,H,F,ne,J,te,q,ve,se=new Uint8Array(l+1);for(G=0;G<_;G++){for(var le=0;le<l;le++)se[le]=t[a++];for(ve=0,$=0;$<l-30;ve+=16){for(K=2047&(Y=c.readUint(se,ve)),H=2047&Y>>>11,F=15&Y>>>22,ne=15&Y>>>26,J=0;J<4&&128<<J<=K-H;J++);for(te=30,q=0;q<16;q++)q==F?I[q]=K:q==ne?I[q]=H:(I[q]=((c.readUshort(se,ve+(te>>3))>>>(te&7)&127)<<J)+H,I[q]>2047&&(I[q]=2047),te+=7);for(q=0;q<16;q++,$+=2){var T=I[q]<<1;u.decode._putsF(v,(G*l+$)*S,T<<16-S)}$-=$&1?1:31}}},u.decode._decodeNikon=function(r,t,a,w,v,f,l){var _=[[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,5,4,3,6,2,7,1,0,8,9,11,10,12],[0,0,1,5,1,1,1,1,1,1,2,0,0,0,0,0,0,57,90,56,39,22,5,4,3,2,1,0,11,12,12],[0,0,1,4,2,3,1,2,0,0,0,0,0,0,0,0,0,5,4,6,3,7,2,8,1,9,0,10,11,12],[0,0,1,4,3,1,1,1,1,1,2,0,0,0,0,0,0,5,6,4,7,8,3,9,2,1,0,10,11,12,13,14],[0,0,1,5,1,1,1,1,1,1,1,2,0,0,0,0,0,8,92,75,58,41,7,6,5,4,3,2,1,0,13,14],[0,0,1,4,2,2,3,1,2,0,0,0,0,0,0,0,0,7,6,8,5,9,4,10,3,11,12,2,0,1,13,14]],S=r.t256[0],c=r.t257[0],g=r.t258[0],p=0,d=0,n=u.decode._make_decoder,b=u.decode._getbithuff,E=t[0].exifIFD.makerNote,y=E.t150?E.t150:E.t140,x=0,D=y[x++],T=y[x++];(D==73||T==88)&&(x+=2110),D==70&&(p=2),g==14&&(p+=3);for(var M=[[0,0],[0,0]],B=r.isLE?u._binLE:u._binBE,Y=0;Y<2;Y++)for(var Z=0;Z<2;Z++)M[Y][Z]=B.readShort(y,x),x+=2;var I=1<<g&32767,G=0,$=B.readShort(y,x);x+=2,$>1&&(G=Math.floor(I/($-1))),D==68&&T==32&&G>0&&(d=B.readShort(y,562));var Y,K,H,F,ne,J,te=[0,0],q=n(_[p]),ve=[w,0,0,0];for(K=0;K<c;K++)for(d&&K==d&&(q=n(_[p+1])),H=0;H<S;H++){Y=b(a,ve,q[0],q),F=Y&15,ne=Y>>>4,J=(b(a,ve,F-ne,0)<<1)+1<<ne>>>1,(J&1<<F-1)==0&&(J-=(1<<F)-(ne==0?1:0)),H<2?te[H]=M[K&1][H]+=J:te[H&1]+=J;var se=Math.min(Math.max(te[H&1],0),(1<<g)-1),le=(K*S+H)*g;u.decode._putsF(f,le,se<<16-g)}},u.decode._putsF=function(r,t,a){a=a<<8-(t&7);var w=t>>>3;r[w]|=a>>>16,r[w+1]|=a>>>8,r[w+2]|=a},u.decode._getbithuff=function(r,t,a,w){var v=0;u.decode._get_byte;var f,l=t[0],_=t[1],S=t[2],c=t[3];if(a==0||S<0)return 0;for(;!c&&S<a&&(f=r[l++])!=-1&&!(c=v);)_=(_<<8)+f,S+=8;if(f=_<<32-S>>>32-a,w?(S-=w[f+1]>>>8,f=w[f+1]&255):S-=a,S<0)throw"e";return t[0]=l,t[1]=_,t[2]=S,t[3]=c,f},u.decode._make_decoder=function(r){var t,a,w,v,f,l=[];for(t=16;t!=0&&!r[t];t--);var _=17;for(l[0]=t,w=a=1;a<=t;a++)for(v=0;v<r[a];v++,++_)for(f=0;f<1<<t-a;f++)w<=1<<t&&(l[w++]=a<<8|r[_]);return l},u.decode._decodeNewJPEG=function(r,t,a,w,v,f){var l=r.t347,_=l?l.length:0,S=new Uint8Array(_+w);if(l){for(var c=216,g=217,p=0,d=0;d<_-1&&!(l[d]==255&&l[d+1]==g);d++)S[p++]=l[d];var n=t[a],b=t[a+1];(n!=255||b!=c)&&(S[p++]=n,S[p++]=b);for(var d=2;d<w;d++)S[p++]=t[a+d]}else for(var d=0;d<w;d++)S[d]=t[a+d];if(r.t262[0]==32803||r.t262[0]==34892){var E=r.t258[0],y=u.LosslessJpegDecode(S),x=y.length;if(E==16)if(r.isLE)for(var d=0;d<x;d++)v[f+(d<<1)]=y[d]&255,v[f+(d<<1)+1]=y[d]>>>8;else for(var d=0;d<x;d++)v[f+(d<<1)]=y[d]>>>8,v[f+(d<<1)+1]=y[d]&255;else if(E==14||E==12)for(var D=16-E,d=0;d<x;d++)u.decode._putsF(v,d*E,y[d]<<D);else throw new Error("unsupported bit depth "+E)}else{var T=new u.JpegDecoder;T.parse(S);for(var M=T.getData(T.width,T.height),d=0;d<M.length;d++)v[f+d]=M[d]}r.t262[0]==6&&(r.t262[0]=2)},u.decode._decodeOldJPEGInit=function(r,t,a,w){var v=216,f=219,l=196,_=221,S=192,c=218,g=0,p=0,d,n,b=!1,E,y,x,D=r.t513,T=D?D[0]:0,M=r.t514,B=M?M[0]:0,Z=r.t324||r.t273||D,I=r.t530,G=0,$=0,Y=r.t277?r.t277[0]:1,K=r.t515;if(Z&&(p=Z[0],b=Z.length>1),!b){if(t[a]==255&&t[a+1]==v)return{jpegOffset:a};if(D!=null&&(t[a+T]==255&&t[a+T+1]==v?g=a+T:A("JPEGInterchangeFormat does not point to SOI"),M==null?A("JPEGInterchangeFormatLength field is missing"):(T>=p||T+B<=p)&&A("JPEGInterchangeFormatLength field value is invalid"),g!=null))return{jpegOffset:g}}if(I!=null&&(G=I[0],$=I[1]),D!=null&&M!=null)if(B>=2&&T+B<=p){for(t[a+T+B-2]==255&&t[a+T+B-1]==v?d=new Uint8Array(B-2):d=new Uint8Array(B),E=0;E<d.length;E++)d[E]=t[a+T+E];A("Incorrect JPEG interchange format: using JPEGInterchangeFormat offset to derive tables")}else A("JPEGInterchangeFormat+JPEGInterchangeFormatLength > offset to first strip or tile");if(d==null){var H=0,F=[];F[H++]=255,F[H++]=v;var ne=r.t519;if(ne==null)throw new Error("JPEGQTables tag is missing");for(E=0;E<ne.length;E++)for(F[H++]=255,F[H++]=f,F[H++]=0,F[H++]=67,F[H++]=E,y=0;y<64;y++)F[H++]=t[a+ne[E]+y];for(x=0;x<2;x++){var J=r[x==0?"t520":"t521"];if(J==null)throw new Error((x==0?"JPEGDCTables":"JPEGACTables")+" tag is missing");for(E=0;E<J.length;E++){F[H++]=255,F[H++]=l;var te=19;for(y=0;y<16;y++)te+=t[a+J[E]+y];for(F[H++]=te>>>8,F[H++]=te&255,F[H++]=E|x<<4,y=0;y<16;y++)F[H++]=t[a+J[E]+y];for(y=0;y<te;y++)F[H++]=t[a+J[E]+16+y]}}if(F[H++]=255,F[H++]=S,F[H++]=0,F[H++]=8+3*Y,F[H++]=8,F[H++]=r.height>>>8&255,F[H++]=r.height&255,F[H++]=r.width>>>8&255,F[H++]=r.width&255,F[H++]=Y,Y==1)F[H++]=1,F[H++]=17,F[H++]=0;else for(E=0;E<3;E++)F[H++]=E+1,F[H++]=E!=0?17:(G&15)<<4|$&15,F[H++]=E;K!=null&&K[0]!=0&&(F[H++]=255,F[H++]=_,F[H++]=0,F[H++]=4,F[H++]=K[0]>>>8&255,F[H++]=K[0]&255),d=new Uint8Array(F)}var q=-1;for(E=0;E<d.length-1;){if(d[E]==255&&d[E+1]==S){q=E;break}E++}if(q==-1){var ve=new Uint8Array(d.length+10+3*Y);ve.set(d);var se=d.length;if(q=d.length,d=ve,d[se++]=255,d[se++]=S,d[se++]=0,d[se++]=8+3*Y,d[se++]=8,d[se++]=r.height>>>8&255,d[se++]=r.height&255,d[se++]=r.width>>>8&255,d[se++]=r.width&255,d[se++]=Y,Y==1)d[se++]=1,d[se++]=17,d[se++]=0;else for(E=0;E<3;E++)d[se++]=E+1,d[se++]=E!=0?17:(G&15)<<4|$&15,d[se++]=E}if(t[p]==255&&t[p+1]==c){var le=t[p+2]<<8|t[p+3];for(n=new Uint8Array(le+2),n[0]=t[p],n[1]=t[p+1],n[2]=t[p+2],n[3]=t[p+3],E=0;E<le-2;E++)n[E+4]=t[p+E+4]}else{n=new Uint8Array(8+2*Y);var he=0;if(n[he++]=255,n[he++]=c,n[he++]=0,n[he++]=6+2*Y,n[he++]=Y,Y==1)n[he++]=1,n[he++]=0;else for(E=0;E<3;E++)n[he++]=E+1,n[he++]=E<<4|E;n[he++]=0,n[he++]=63,n[he++]=0}return{jpegOffset:a,tables:d,sosMarker:n,sofPosition:q}},u.decode._decodeOldJPEG=function(r,t,a,w,v,f){var l,_,S,c,g,p=u.decode._decodeOldJPEGInit(r,t,a,w);if(p.jpegOffset!=null)for(_=a+w-p.jpegOffset,c=new Uint8Array(_),l=0;l<_;l++)c[l]=t[p.jpegOffset+l];else{for(S=p.tables.length,c=new Uint8Array(S+p.sosMarker.length+w+2),c.set(p.tables),g=S,c[p.sofPosition+5]=r.height>>>8&255,c[p.sofPosition+6]=r.height&255,c[p.sofPosition+7]=r.width>>>8&255,c[p.sofPosition+8]=r.width&255,(t[a]!=255||t[a+1]!=SOS)&&(c.set(p.sosMarker,g),g+=sosMarker.length),l=0;l<w;l++)c[g++]=t[a+l];c[g++]=255,c[g++]=EOI}var d=new u.JpegDecoder;d.parse(c);for(var n=d.getData(d.width,d.height),l=0;l<n.length;l++)v[f+l]=n[l];r.t262&&r.t262[0]==6&&(r.t262[0]=2)},u.decode._decodePackBits=function(r,t,a,w,v){for(var f=new Int8Array(r.buffer),l=new Int8Array(w.buffer),_=t+a;t<_;){var S=f[t];if(t++,S>=0&&S<128)for(var c=0;c<S+1;c++)l[v]=f[t],v++,t++;if(S>=-127&&S<0){for(var c=0;c<-S+1;c++)l[v]=f[t],v++;t++}}},u.decode._decodeThunder=function(r,t,a,w,v){for(var f=[0,1,0,-1],l=[0,1,2,3,0,-3,-2,-1],_=t+a,S=v*2,c=0;t<_;){var g=r[t],p=g>>>6,d=g&63;if(t++,p==3&&(c=d&15,w[S>>>1]|=c<<4*(1-S&1),S++),p==0)for(var n=0;n<d;n++)w[S>>>1]|=c<<4*(1-S&1),S++;if(p==2)for(var n=0;n<2;n++){var b=d>>>3*(1-n)&7;b!=4&&(c+=l[b],w[S>>>1]|=c<<4*(1-S&1),S++)}if(p==1)for(var n=0;n<3;n++){var b=d>>>2*(2-n)&3;b!=2&&(c+=f[b],w[S>>>1]|=c<<4*(1-S&1),S++)}}},u.decode._dmap={1:0,"011":1,"000011":2,"0000011":3,"010":-1,"000010":-2,"0000010":-3},u.decode._lens=function(){var r=function(S,c,g,p){for(var d=0;d<c.length;d++)S[c[d]]=g+d*p},t="00110101,000111,0111,1000,1011,1100,1110,1111,10011,10100,00111,01000,001000,000011,110100,110101,101010,101011,0100111,0001100,0001000,0010111,0000011,0000100,0101000,0101011,0010011,0100100,0011000,00000010,00000011,00011010,00011011,00010010,00010011,00010100,00010101,00010110,00010111,00101000,00101001,00101010,00101011,00101100,00101101,00000100,00000101,00001010,00001011,01010010,01010011,01010100,01010101,00100100,00100101,01011000,01011001,01011010,01011011,01001010,01001011,00110010,00110011,00110100",a="0000110111,010,11,10,011,0011,0010,00011,000101,000100,0000100,0000101,0000111,00000100,00000111,000011000,0000010111,0000011000,0000001000,00001100111,00001101000,00001101100,00000110111,00000101000,00000010111,00000011000,000011001010,000011001011,000011001100,000011001101,000001101000,000001101001,000001101010,000001101011,000011010010,000011010011,000011010100,000011010101,000011010110,000011010111,000001101100,000001101101,000011011010,000011011011,000001010100,000001010101,000001010110,000001010111,000001100100,000001100101,000001010010,000001010011,000000100100,000000110111,000000111000,000000100111,000000101000,000001011000,000001011001,000000101011,000000101100,000001011010,000001100110,000001100111",w="11011,10010,010111,0110111,00110110,00110111,01100100,01100101,01101000,01100111,011001100,011001101,011010010,011010011,011010100,011010101,011010110,011010111,011011000,011011001,011011010,011011011,010011000,010011001,010011010,011000,010011011",v="0000001111,000011001000,000011001001,000001011011,000000110011,000000110100,000000110101,0000001101100,0000001101101,0000001001010,0000001001011,0000001001100,0000001001101,0000001110010,0000001110011,0000001110100,0000001110101,0000001110110,0000001110111,0000001010010,0000001010011,0000001010100,0000001010101,0000001011010,0000001011011,0000001100100,0000001100101",f="00000001000,00000001100,00000001101,000000010010,000000010011,000000010100,000000010101,000000010110,000000010111,000000011100,000000011101,000000011110,000000011111";t=t.split(","),a=a.split(","),w=w.split(","),v=v.split(","),f=f.split(",");var l={},_={};return r(l,t,0,1),r(l,w,64,64),r(l,f,1792,64),r(_,a,0,1),r(_,v,64,64),r(_,f,1792,64),[l,_]}(),u.decode._decodeG4=function(r,t,a,w,v,f,l){for(var _=u.decode,S=t<<3,c=0,g="",p=[],d=[],n=0;n<f;n++)d.push(0);d=_._makeDiff(d);for(var b=0,E=0,y=0,x=0,D=0,T=0,M="",B=0,Z=Math.ceil(f/8)*8;S>>>3<t+a;){y=_._findDiff(d,b+(b==0?0:1),1-D),x=_._findDiff(d,y,D);var I=0;if(l==1&&(I=r[S>>>3]>>>7-(S&7)&1),l==2&&(I=r[S>>>3]>>>(S&7)&1),S++,g+=I,M=="H"){if(_._lens[D][g]!=null){var G=_._lens[D][g];g="",c+=G,G<64&&(_._addNtimes(p,c,D),b+=c,D=1-D,c=0,B--,B==0&&(M=""))}}else g=="0001"&&(g="",_._addNtimes(p,x-b,D),b=x),g=="001"&&(g="",M="H",B=2),_._dmap[g]!=null&&(E=y+_._dmap[g],_._addNtimes(p,E-b,D),b=E,g="",D=1-D);p.length==f&&M==""&&(_._writeBits(p,w,v*8+T*Z),D=0,T++,b=0,d=_._makeDiff(p),p=[])}},u.decode._findDiff=function(r,t,a){for(var w=0;w<r.length;w+=2)if(r[w]>=t&&r[w+1]==a)return r[w]},u.decode._makeDiff=function(r){var t=[];r[0]==1&&t.push(0,1);for(var a=1;a<r.length;a++)r[a-1]!=r[a]&&t.push(a,r[a]);return t.push(r.length,0,r.length,1),t},u.decode._decodeG3=function(r,t,a,w,v,f,l){for(var _=u.decode,S=t<<3,c=0,g="",p=[],d=[],n=0;n<f;n++)p.push(0);for(var b=0,E=0,y=0,x=0,D=0,T=-1,M="",B=0,Z=!1,I=Math.ceil(f/8)*8;S>>>3<t+a;){y=_._findDiff(d,b+(b==0?0:1),1-D),x=_._findDiff(d,y,D);var G=0;if(l==1&&(G=r[S>>>3]>>>7-(S&7)&1),l==2&&(G=r[S>>>3]>>>(S&7)&1),S++,g+=G,Z){if(_._lens[D][g]!=null){var $=_._lens[D][g];g="",c+=$,$<64&&(_._addNtimes(p,c,D),D=1-D,c=0)}}else if(M=="H"){if(_._lens[D][g]!=null){var $=_._lens[D][g];g="",c+=$,$<64&&(_._addNtimes(p,c,D),b+=c,D=1-D,c=0,B--,B==0&&(M=""))}}else g=="0001"&&(g="",_._addNtimes(p,x-b,D),b=x),g=="001"&&(g="",M="H",B=2),_._dmap[g]!=null&&(E=y+_._dmap[g],_._addNtimes(p,E-b,D),b=E,g="",D=1-D);g.endsWith("000000000001")&&(T>=0&&_._writeBits(p,w,v*8+T*I),l==1&&(Z=(r[S>>>3]>>>7-(S&7)&1)==1),l==2&&(Z=(r[S>>>3]>>>(S&7)&1)==1),S++,_._decodeG3.allow2D==null&&(_._decodeG3.allow2D=Z),_._decodeG3.allow2D||(Z=!0,S--),g="",D=0,T++,b=0,d=_._makeDiff(p),p=[])}p.length==f&&_._writeBits(p,w,v*8+T*I)},u.decode._addNtimes=function(r,t,a){for(var w=0;w<t;w++)r.push(a)},u.decode._writeBits=function(r,t,a){for(var w=0;w<r.length;w++)t[a+w>>>3]|=r[w]<<7-(a+w&7)},u.decode._decodeLZW=function(r,t,a,w){if(u.decode._lzwTab==null){for(var v=new Uint32Array(65535),f=new Uint16Array(65535),g=new Uint8Array(2e6),l=0;l<256;l++)g[l<<2]=l,v[l]=l<<2,f[l]=1;u.decode._lzwTab=[v,f,g]}for(var _=u.decode._copyData,S=u.decode._lzwTab[0],c=u.decode._lzwTab[1],g=u.decode._lzwTab[2],p=258,d=1032,n=9,b=t<<3,E=256,y=257,x=0,D=0,T=0;x=r[b>>>3]<<16|r[b+8>>>3]<<8|r[b+16>>>3],D=x>>24-(b&7)-n&(1<<n)-1,b+=n,D!=y;){if(D==E){if(n=9,p=258,d=1032,x=r[b>>>3]<<16|r[b+8>>>3]<<8|r[b+16>>>3],D=x>>24-(b&7)-n&(1<<n)-1,b+=n,D==y)break;a[w]=D,w++}else if(D<p){var M=S[D],B=c[D];if(_(g,M,a,w,B),w+=B,T>=p)S[p]=d,g[S[p]]=M[0],c[p]=1,d=d+1+3&-4,p++;else{S[p]=d;var Z=S[T],I=c[T];_(g,Z,g,d,I),g[d+I]=g[M],I++,c[p]=I,p++,d=d+I+3&-4}p+1==1<<n&&n++}else{if(T>=p)S[p]=d,c[p]=0,p++;else{S[p]=d;var Z=S[T],I=c[T];_(g,Z,g,d,I),g[d+I]=g[d],I++,c[p]=I,p++,_(g,d,a,w,I),w+=I,d=d+I+3&-4}p+1==1<<n&&n++}T=D}},u.decode._copyData=function(r,t,a,w,v){for(var f=0;f<v;f+=4)a[w+f]=r[t+f],a[w+f+1]=r[t+f+1],a[w+f+2]=r[t+f+2],a[w+f+3]=r[t+f+3]},u.tags={},u.ttypes={256:3,257:3,258:3,259:3,262:3,273:4,274:3,277:3,278:4,279:4,282:5,283:5,284:3,286:5,287:5,296:3,305:2,306:2,338:3,513:4,514:4,34665:4},u._readIFD=function(r,t,a,w,v,f){var l=r.readUshort(t,a);a+=2;var _={};w.push(_),f&&A("   ".repeat(v),w.length-1,">>>----------------");for(var S=0;S<l;S++){var c=r.readUshort(t,a);a+=2;var g=r.readUshort(t,a);a+=2;var p=r.readUint(t,a);a+=4;var d=r.readUint(t,a);a+=4;var n=[];if((g==1||g==7)&&(n=new Uint8Array(t.buffer,p<5?a-4:d,p)),g==2){var b=p<5?a-4:d,E=t[b];E<128?n.push(r.readASCII(t,b,p-1)):n=new Uint8Array(t.buffer,b,p-1)}if(g==3)for(var y=0;y<p;y++)n.push(r.readUshort(t,(p<3?a-4:d)+2*y));if(g==4)for(var y=0;y<p;y++)n.push(r.readUint(t,(p<2?a-4:d)+4*y));if(g==5)for(var y=0;y<p;y++)n.push(r.readUint(t,d+y*8)/r.readUint(t,d+y*8+4));if(g==8)for(var y=0;y<p;y++)n.push(r.readShort(t,(p<3?a-4:d)+2*y));if(g==9)for(var y=0;y<p;y++)n.push(r.readInt(t,(p<2?a-4:d)+4*y));if(g==10)for(var y=0;y<p;y++)n.push(r.readInt(t,d+y*8)/r.readInt(t,d+y*8+4));if(g==11)for(var y=0;y<p;y++)n.push(r.readFloat(t,d+y*4));if(g==12)for(var y=0;y<p;y++)n.push(r.readDouble(t,d+y*8));if(_["t"+c]=n,p!=0&&n.length==0&&A("unknown TIFF tag type: ",g,"num:",p),f&&A("   ".repeat(v),c,g,u.tags[c],n),!(c==330&&_.t272&&_.t272[0]=="DSLR-A100")){if(c==330||c==34665||c==50740&&r.readUshort(t,r.readUint(n,0))<300){for(var x=c==50740?[r.readUint(n,0)]:n,D=[],y=0;y<x.length;y++)u._readIFD(r,t,x[y],D,v+1,f);c==330&&(_.subIFD=D),c==34665&&(_.exifIFD=D[0]),c==50740&&(_.dngPrvt=D[0])}}if(c==37500){var T=n;if(r.readASCII(T,0,5)=="Nikon")_.makerNote=u.decode(T.slice(10).buffer)[0];else if(r.readUshort(t,d)<300){var M=[];u._readIFD(r,t,d,M,v+1,f),_.makerNote=M[0]}}}return f&&A("   ".repeat(v),"<<<---------------"),a},u._writeIFD=function(r,t,a,w){var v=Object.keys(w);r.writeUshort(t,a,v.length),a+=2;for(var f=a+v.length*12+4,l=0;l<v.length;l++){var _=v[l],S=parseInt(_.slice(1)),c=u.ttypes[S];if(c==null)throw new Error("unknown type of tag: "+S);var g=w[_];c==2&&(g=g[0]+"\0");var p=g.length;r.writeUshort(t,a,S),a+=2,r.writeUshort(t,a,c),a+=2,r.writeUint(t,a,p),a+=4;var d=[-1,1,1,2,4,8,0,0,0,0,0,0,8][c]*p,n=a;if(d>4&&(r.writeUint(t,a,f),n=f),c==2&&r.writeASCII(t,n,g),c==3)for(var b=0;b<p;b++)r.writeUshort(t,n+2*b,g[b]);if(c==4)for(var b=0;b<p;b++)r.writeUint(t,n+4*b,g[b]);if(c==5)for(var b=0;b<p;b++)r.writeUint(t,n+8*b,Math.round(g[b]*1e4)),r.writeUint(t,n+8*b+4,1e4);if(c==12)for(var b=0;b<p;b++)r.writeDouble(t,n+8*b,g[b]);d>4&&(d+=d&1,f+=d),a+=4}return[a,f]},u.toRGBA8=function(r){var t=r.width,a=r.height,w=t*a,v=w*4,f=r.data,l=new Uint8Array(w*4),_=r.t262?r.t262[0]:2,S=r.t258?Math.min(32,r.t258[0]):1;if(_==0)for(var c=Math.ceil(S*t/8),g=0;g<a;g++){var p=g*c,d=g*t;if(S==1)for(var n=0;n<t;n++){var b=d+n<<2,E=f[p+(n>>3)]>>7-(n&7)&1;l[b]=l[b+1]=l[b+2]=(1-E)*255,l[b+3]=255}if(S==4)for(var n=0;n<t;n++){var b=d+n<<2,E=f[p+(n>>1)]>>4-4*(n&1)&15;l[b]=l[b+1]=l[b+2]=(15-E)*17,l[b+3]=255}if(S==8)for(var n=0;n<t;n++){var b=d+n<<2,E=f[p+n];l[b]=l[b+1]=l[b+2]=255-E,l[b+3]=255}}else if(_==1)for(var c=Math.ceil(S*t/8),g=0;g<a;g++){var p=g*c,d=g*t;if(S==1)for(var n=0;n<t;n++){var b=d+n<<2,E=f[p+(n>>3)]>>7-(n&7)&1;l[b]=l[b+1]=l[b+2]=E*255,l[b+3]=255}if(S==2)for(var n=0;n<t;n++){var b=d+n<<2,E=f[p+(n>>2)]>>6-2*(n&3)&3;l[b]=l[b+1]=l[b+2]=E*85,l[b+3]=255}if(S==8)for(var n=0;n<t;n++){var b=d+n<<2,E=f[p+n];l[b]=l[b+1]=l[b+2]=E,l[b+3]=255}if(S==16)for(var n=0;n<t;n++){var b=d+n<<2,E=f[p+(2*n+1)];l[b]=l[b+1]=l[b+2]=Math.min(255,E),l[b+3]=255}}else if(_==2){var y=r.t258?r.t258.length:3;if(S==8){if(y==4)for(var n=0;n<v;n++)l[n]=f[n];if(y==3)for(var n=0;n<w;n++){var b=n<<2,x=n*3;l[b]=f[x],l[b+1]=f[x+1],l[b+2]=f[x+2],l[b+3]=255}}else{if(y==4)for(var n=0;n<w;n++){var b=n<<2,x=n*8+1;l[b]=f[x],l[b+1]=f[x+2],l[b+2]=f[x+4],l[b+3]=f[x+6]}if(y==3)for(var n=0;n<w;n++){var b=n<<2,x=n*6+1;l[b]=f[x],l[b+1]=f[x+2],l[b+2]=f[x+4],l[b+3]=255}}}else if(_==3)for(var D=r.t320,n=0;n<w;n++){var b=n<<2,T=f[n];l[b]=D[T]>>8,l[b+1]=D[256+T]>>8,l[b+2]=D[512+T]>>8,l[b+3]=255}else if(_==5)for(var y=r.t258?r.t258.length:4,M=y>4?1:0,n=0;n<w;n++){var b=n<<2,B=n*y,Z=255-f[B],I=255-f[B+1],G=255-f[B+2],$=(255-f[B+3])*(1/255);l[b]=~~(Z*$+.5),l[b+1]=~~(I*$+.5),l[b+2]=~~(G*$+.5),l[b+3]=255*(1-M)+f[B+4]*M}else A("Unknown Photometric interpretation: "+_);return l},u.replaceIMG=function(r){r==null&&(r=document.getElementsByTagName("img"));for(var t=["tif","tiff","dng","cr2","nef"],a=0;a<r.length;a++){var w=r[a],v=w.getAttribute("src");if(v!=null){var f=v.split(".").pop().toLowerCase();if(t.indexOf(f)!=-1){var l=new XMLHttpRequest;u._xhrs.push(l),u._imgs.push(w),l.open("GET",v),l.responseType="arraybuffer",l.onload=u._imgLoaded,l.send()}}}},u._xhrs=[],u._imgs=[],u._imgLoaded=function(r){var t=r.target.response,a=u.decode(t),w=a,v=0,f=w[0];a[0].subIFD&&(w=w.concat(a[0].subIFD));for(var l=0;l<w.length;l++){var d=w[l];if(!(d.t258==null||d.t258.length<3)){var _=d.t256*d.t257;_>v&&(v=_,f=d)}}u.decodeImage(t,f,a);var S=u.toRGBA8(f),c=f.width,g=f.height,p=u._xhrs.indexOf(r.target),d=u._imgs[p];u._xhrs.splice(p,1),u._imgs.splice(p,1);var n=document.createElement("canvas");n.width=c,n.height=g;for(var b=n.getContext("2d"),E=b.createImageData(c,g),l=0;l<S.length;l++)E.data[l]=S[l];b.putImageData(E,0,0),d.setAttribute("src",n.toDataURL())},u._binBE={nextZero:function(r,t){for(;r[t]!=0;)t++;return t},readUshort:function(r,t){return r[t]<<8|r[t+1]},readShort:function(r,t){var a=u._binBE.ui8;return a[0]=r[t+1],a[1]=r[t+0],u._binBE.i16[0]},readInt:function(r,t){var a=u._binBE.ui8;return a[0]=r[t+3],a[1]=r[t+2],a[2]=r[t+1],a[3]=r[t+0],u._binBE.i32[0]},readUint:function(r,t){var a=u._binBE.ui8;return a[0]=r[t+3],a[1]=r[t+2],a[2]=r[t+1],a[3]=r[t+0],u._binBE.ui32[0]},readASCII:function(r,t,a){for(var w="",v=0;v<a;v++)w+=String.fromCharCode(r[t+v]);return w},readFloat:function(r,t){for(var a=u._binBE.ui8,w=0;w<4;w++)a[w]=r[t+3-w];return u._binBE.fl32[0]},readDouble:function(r,t){for(var a=u._binBE.ui8,w=0;w<8;w++)a[w]=r[t+7-w];return u._binBE.fl64[0]},writeUshort:function(r,t,a){r[t]=a>>8&255,r[t+1]=a&255},writeUint:function(r,t,a){r[t]=a>>24&255,r[t+1]=a>>16&255,r[t+2]=a>>8&255,r[t+3]=a>>0&255},writeASCII:function(r,t,a){for(var w=0;w<a.length;w++)r[t+w]=a.charCodeAt(w)},writeDouble:function(r,t,a){u._binBE.fl64[0]=a;for(var w=0;w<8;w++)r[t+w]=u._binBE.ui8[7-w]}},u._binBE.ui8=new Uint8Array(8),u._binBE.i16=new Int16Array(u._binBE.ui8.buffer),u._binBE.i32=new Int32Array(u._binBE.ui8.buffer),u._binBE.ui32=new Uint32Array(u._binBE.ui8.buffer),u._binBE.fl32=new Float32Array(u._binBE.ui8.buffer),u._binBE.fl64=new Float64Array(u._binBE.ui8.buffer),u._binLE={nextZero:u._binBE.nextZero,readUshort:function(r,t){return r[t+1]<<8|r[t]},readShort:function(r,t){var a=u._binBE.ui8;return a[0]=r[t+0],a[1]=r[t+1],u._binBE.i16[0]},readInt:function(r,t){var a=u._binBE.ui8;return a[0]=r[t+0],a[1]=r[t+1],a[2]=r[t+2],a[3]=r[t+3],u._binBE.i32[0]},readUint:function(r,t){var a=u._binBE.ui8;return a[0]=r[t+0],a[1]=r[t+1],a[2]=r[t+2],a[3]=r[t+3],u._binBE.ui32[0]},readASCII:u._binBE.readASCII,readFloat:function(r,t){for(var a=u._binBE.ui8,w=0;w<4;w++)a[w]=r[t+w];return u._binBE.fl32[0]},readDouble:function(r,t){for(var a=u._binBE.ui8,w=0;w<8;w++)a[w]=r[t+w];return u._binBE.fl64[0]}},u._copyTile=function(r,t,a,w,v,f,l,_){for(var S=Math.min(t,v-l),c=Math.min(a,f-_),g=0;g<c;g++)for(var p=(_+g)*v+l,d=g*t,n=0;n<S;n++)w[p+n]=r[d+n]},u.LosslessJpegDecode=function(){function r(v){this.w=v,this.N=0,this._=0,this.G=0}r.prototype={t:function(v){this.N=Math.max(0,Math.min(this.w.length,v))},i:function(){return this.w[this.N++]},l:function(){var v=this.N;return this.N+=2,this.w[v]<<8|this.w[v+1]},J:function(){return this._==0&&(this.G=this.w[this.N],this.N+=1+(this.G+1>>>8),this._=8),this.G>>>--this._&1},Z:function(v){var f=this._,l=this.G,_=Math.min(f,v);v-=_,f-=_;for(var S=l>>>f&(1<<_)-1;v>0;)l=this.w[this.N],this.N+=1+(l+1>>>8),_=Math.min(8,v),v-=_,f=8-_,S<<=_,S|=l>>>f&(1<<_)-1;return this._=f,this.G=l,S}};var t={};t.X=function(){return[0,0,-1]},t.s=function(v,f,l){v[t.Y(v,0,l)+2]=f},t.Y=function(v,f,l){if(v[f+2]!=-1)return 0;if(l==0)return f;for(var _=0;_<2;_++){v[f+_]==0&&(v[f+_]=v.length,v.push(0),v.push(0),v.push(-1));var S=t.Y(v,v[f+_],l-1);if(S!=0)return S}return 0},t.B=function(v,f){for(var l=0,_=0,S=0,c=f._,g=f.G,p=f.N;;)if(c==0&&(g=f.w[p],p+=1+(g+1>>>8),c=8),S=g>>>--c&1,l=v[l+S],_=v[l+2],_!=-1)return f._=c,f.G=g,f.N=p,_;return-1};function a(v){this.z=new r(v),this.D(this.z)}a.prototype={$:function(v,f){this.Q=v.i(),this.F=v.l(),this.o=v.l();var l=this.O=v.i();this.L=[];for(var _=0;_<l;_++){var S=v.i();v.i(),v.i(),this.L[S]=_}v.t(v.N+f-(6+l*3))},e:function(){var v=0,f=this.z.i();this.H==null&&(this.H={});for(var l=this.H[f]=t.X(),_=[],S=0;S<16;S++)_[S]=this.z.i(),v+=_[S];for(var S=0;S<16;S++)for(var c=0;c<_[S];c++)t.s(l,this.z.i(),S+1);return v+17},W:function(v){for(;v>0;)v-=this.e()},p:function(v,f){var l=v.i();this.U||(this.U=[]);for(var _=0;_<l;_++){var S=v.i(),c=v.i();this.U[this.L[S]]=this.H[c>>>4]}this.g=v.i(),v.t(v.N+f-(2+l*2))},D:function(v){var f=!1,l=v.l();if(l===a.q)do{var l=v.l(),_=v.l()-2;switch(l){case a.m:this.$(v,_);break;case a.K:this.W(_);break;case a.V:this.p(v,_),f=!0;break;default:v.t(v.N+_);break}}while(!f)},I:function(v,f){var l=t.B(f,v);if(l==16)return-32768;var _=v.Z(l);return(_&1<<l-1)==0&&(_-=(1<<l)-1),_},B:function(v,f){for(var l=this.z,_=this.O,S=this.F,c=this.I,g=this.g,p=this.o*_,d=this.U,n=0;n<_;n++)v[n]=c(l,d[n])+(1<<this.Q-1);for(var b=_;b<p;b+=_)for(var n=0;n<_;n++)v[b+n]=c(l,d[n])+v[b+n-_];for(var E=f,y=1;y<S;y++){for(var n=0;n<_;n++)v[E+n]=c(l,d[n])+v[E+n-f];for(var b=_;b<p;b+=_)for(var n=0;n<_;n++){var x=E+b+n,D=v[x-_];g==6&&(D=v[x-f]+(D-v[x-_-f]>>>1)),v[x]=D+c(l,d[n])}E+=f}}},a.m=65475,a.K=65476,a.q=65496,a.V=65498;function w(v){var f=new a(v),l=f.Q>8?Uint16Array:Uint8Array,_=new l(f.o*f.F*f.O),S=f.o*f.O;return f.B(_,S),_}return w}()})(s,m)})()}(ct)),ct.exports}var kt=ur();class vr extends rr{constructor(s){super(s),this.pages=[]}canHandle(s){return s.type.startsWith("image/")||this.isTiffFile(s)}async loadFile(s){this.stateManager.startLoading({name:s.name,size:s.size,type:s.type});try{this.originalFile=s,this.pages=[],this.isTiffFile(s)?await this.loadTiffFile(s):await this.loadRegularImage(s),this.stateManager.finishLoading(this.pages.length)}catch(m){const A=m instanceof Error?m.message:"Unknown error";throw this.stateManager.setError(A),m}}getPages(){return[...this.pages]}getCurrentPage(){const s=this.stateManager.getState();return this.pages[s.currentPage]||null}async goToPage(s){const m=this.stateManager.getState();if(s<0||s>=m.totalPages)throw new Error(`Page index ${s} out of range (0-${m.totalPages-1})`);this.stateManager.navigateToPage(s)}async navigateToPage(s){await this.goToPage(s)}async loadTiffFile(s){const m=await s.arrayBuffer(),A=kt.decode(m);if(!A||A.length===0)throw new Error("No valid TIFF pages found");A.forEach(u=>kt.decodeImage(m,u)),this.pages=A.map((u,P)=>({index:P,imageData:{width:u.width,height:u.height,data:new Uint8ClampedArray(kt.toRGBA8(u)),format:"rgba"},metadata:{colorSpace:u.colorSpace,compression:u.compression,photometric:u.photometric,bitsPerSample:u.bitsPerSample}}))}async loadRegularImage(s){return new Promise((m,A)=>{const u=new Image;u.onload=()=>{try{const P=document.createElement("canvas"),r=P.getContext("2d");if(!r)throw new Error("Cannot get canvas context");P.width=u.width,P.height=u.height,r.drawImage(u,0,0);const t=r.getImageData(0,0,u.width,u.height);this.pages=[{index:0,imageData:{width:u.width,height:u.height,data:t.data,format:"rgba"},metadata:{originalType:s.type,fileName:s.name}}],m()}catch(P){A(P)}finally{URL.revokeObjectURL(u.src)}},u.onerror=()=>{URL.revokeObjectURL(u.src),A(new Error("Failed to load image"))},u.src=URL.createObjectURL(s)})}isTiffFile(s){return s.type==="image/tiff"||s.type==="image/tif"||s.name.toLowerCase().endsWith(".tiff")||s.name.toLowerCase().endsWith(".tif")}destroy(){this.pages=[],this.originalFile=void 0,this.stateManager.resetState()}}class _r{calculateDimensions(s,m,A,u,P=!0){if(!P)return{width:A,height:u};const r=s/m,t=A/u;let a,w;return r>t?(a=Math.min(s,A),w=a/r):(w=Math.min(m,u),a=w*r),{width:Math.round(a),height:Math.round(w)}}}class Xt extends _r{async render(s,m,A={}){const u=m.getContext("2d");if(!u)throw new Error("Cannot get canvas 2D context");const{imageData:P}=s,{maxWidth:r=m.width,maxHeight:t=m.height,preserveAspectRatio:a=!0,backgroundColor:w="transparent"}=A,{width:v,height:f}=this.calculateDimensions(P.width,P.height,r,t,a);(m.width!==r||m.height!==t)&&(m.width=r,m.height=t),this.clear(m),w!=="transparent"&&(u.fillStyle=w,u.fillRect(0,0,m.width,m.height));const l=new ImageData(P.data,P.width,P.height),_=document.createElement("canvas"),S=_.getContext("2d");_.width=P.width,_.height=P.height,S.putImageData(l,0,0);const c=(m.width-v)/2,g=(m.height-f)/2;u.imageSmoothingEnabled=!0,u.imageSmoothingQuality="high",u.drawImage(_,c,g,v,f),A.showFileInfo&&s.metadata&&this.renderFileInfo(u,s,m.width,m.height)}clear(s){const m=s.getContext("2d");m&&m.clearRect(0,0,s.width,s.height)}resize(s,m,A){s.width=m,s.height=A}renderFileInfo(s,m,A,u){const{imageData:P,metadata:r}=m,t=[`Dimensions: ${P.width} × ${P.height}`,`Format: ${P.format.toUpperCase()}`,r?.originalType&&`Type: ${r.originalType}`,r?.fileName&&`File: ${r.fileName}`].filter(Boolean);if(t.length===0)return;const a=12,w=8,v=a+2,f=t.length*v+w*2,l=Math.max(...t.map(_=>s.measureText(_).width))+w*2;s.fillStyle="rgba(0, 0, 0, 0.8)",s.fillRect(10,10,l,f),s.fillStyle="white",s.font=`${a}px monospace`,s.textBaseline="top",t.forEach((_,S)=>{s.fillText(_,10+w,10+w+S*v)})}}class dt extends EventTarget{constructor(s={}){super(),this.config={maxDimensions:{width:1920,height:1080},showFileInfo:!1,enablePagination:!0,preloadPages:1,preserveAspectRatio:!0,backgroundColor:"transparent",...s},this.defaultRenderer=s.renderer||new Xt,this.setupEventForwarding()}canHandle(s){const m=this.createProcessor(s);return m?m.canHandle(s):!1}async loadFile(s){try{if(this.destroy(),!s)throw new Error("File is required");const m=this.createProcessor(s);if(!m)throw new Error(`Unsupported file type: ${s.type}`);this.processor=m,this.setupProcessorEvents(this.processor),await this.processor.loadFile(s);const A=this.processor.getState(),u=ft.getFileInfo(s);return{success:!0,pageCount:A.totalPages,fileInfo:u}}catch(m){const A=m instanceof Error?m.message:"Unknown error occurred";return this.dispatchEvent(new CustomEvent("error",{detail:{error:A}})),{success:!1,error:A}}}getState(){return this.processor?.getState()||null}getPages(){return this.processor?.getPages()||[]}getCurrentPage(){return this.processor?.getCurrentPage()||null}async navigateToPage(s){if(!this.processor)throw new Error("No file loaded");await this.processor.navigateToPage(s)}async nextPage(){if(!this.processor)throw new Error("No file loaded");await this.processor.nextPage()}async previousPage(){if(!this.processor)throw new Error("No file loaded");await this.processor.previousPage()}async jumpToPage(s){await this.navigateToPage(s-1)}getPaginationInfo(){return this.processor?.getPaginationInfo()||null}async renderToTarget(s,m,A){try{const u=this.getCurrentPage();if(!u)throw new Error("No page to render");const P=A||this.defaultRenderer,r={maxWidth:this.config.maxDimensions?.width,maxHeight:this.config.maxDimensions?.height,showFileInfo:this.config.showFileInfo,preserveAspectRatio:this.config.preserveAspectRatio,backgroundColor:this.config.backgroundColor,...m};return await P.render(u,s,r),{success:!0}}catch(u){return{success:!1,error:u instanceof Error?u.message:"Unknown rendering error"}}}getSupportedTypes(){return["image/jpeg","image/jpg","image/png","image/gif","image/webp","image/svg+xml","image/bmp","image/tiff","image/tif"]}getFileInfo(s){return ft.getFileInfo(s)}formatFileSize(s){return ft.formatFileSize(s)}updateConfig(s){this.config={...this.config,...s},s.renderer&&(this.defaultRenderer=s.renderer)}destroy(){this.processor&&(this.processor.destroy(),this.processor=void 0)}createProcessor(s){return s.type.startsWith("image/")||this.isTiffFile(s)?new vr:null}setupEventForwarding(){}setupProcessorEvents(s){s.setEventTarget(this),s.subscribe((m,A)=>{})}isTiffFile(s){return s.type==="image/tiff"||s.type==="image/tif"||s.name.toLowerCase().endsWith(".tiff")||s.name.toLowerCase().endsWith(".tif")}static create(s){return new dt(s)}}class gr{constructor(s,m){this.container=s,this.viewer=new dt({renderer:new Xt,showFileInfo:!0,enablePagination:!0,...m}),this.setupDOM(),this.setupEventListeners()}async loadFile(s){try{const m=await this.viewer.loadFile(s);return m.success?(await this.render(),this.updatePaginationControls(),{success:!0,element:this.container}):{success:!1,error:m.error}}catch(m){const A=m instanceof Error?m.message:"Unknown error";return this.showError(A),{success:!1,error:A}}}async nextPage(){await this.viewer.nextPage(),await this.render(),this.updatePaginationControls()}async previousPage(){await this.viewer.previousPage(),await this.render(),this.updatePaginationControls()}async jumpToPage(s){await this.viewer.jumpToPage(s),await this.render(),this.updatePaginationControls()}getPaginationInfo(){return this.viewer.getPaginationInfo()}canHandle(s){return this.viewer.canHandle(s)}getSupportedTypes(){return this.viewer.getSupportedTypes()}destroy(){this.viewer.destroy(),this.container.innerHTML=""}setupDOM(){this.container.innerHTML="",this.container.className="portyl-container",this.canvas=document.createElement("canvas"),this.canvas.className="portyl-canvas",this.canvas.style.display="block",this.canvas.style.maxWidth="100%",this.canvas.style.maxHeight="100%",this.canvas.style.border="1px solid #ddd",this.canvas.style.borderRadius="4px",this.paginationContainer=document.createElement("div"),this.paginationContainer.className="pagination-controls",this.paginationContainer.style.display="none",this.paginationContainer.style.marginTop="10px",this.paginationContainer.style.textAlign="center",this.container.appendChild(this.canvas),this.container.appendChild(this.paginationContainer),this.resizeCanvas()}setupEventListeners(){this.viewer.addEventListener("pageChanged",()=>{this.render(),this.updatePaginationControls()}),this.viewer.addEventListener("loaded",()=>{this.updatePaginationControls()}),this.viewer.addEventListener("error",s=>{this.showError(s.detail.error)}),window.addEventListener("resize",()=>{this.resizeCanvas(),this.render()})}async render(){if(this.canvas)try{await this.viewer.renderToTarget(this.canvas,{maxWidth:this.canvas.width,maxHeight:this.canvas.height})}catch(s){console.error("Render error:",s)}}resizeCanvas(){if(!this.canvas)return;const s=this.container.getBoundingClientRect(),m=Math.max(400,s.width-20),A=Math.max(300,window.innerHeight*.6);this.canvas.width=m,this.canvas.height=A}updatePaginationControls(){if(!this.paginationContainer)return;const s=this.viewer.getPaginationInfo();if(!s||s.totalPages<=1){this.paginationContainer.style.display="none";return}const{currentPage:m,totalPages:A,canGoPrevious:u,canGoNext:P}=s;this.paginationContainer.innerHTML=`
      <button id="prev-btn" ${u?"":"disabled"}>◀ Previous</button>
      <span>Page ${m} of ${A}</span>
      <input type="number" id="page-input" min="1" max="${A}" value="${m}" style="width: 60px; margin: 0 10px;">
      <button id="next-btn" ${P?"":"disabled"}>Next ▶</button>
    `,this.paginationContainer.style.display="block";const r=this.paginationContainer.querySelector("#prev-btn"),t=this.paginationContainer.querySelector("#next-btn"),a=this.paginationContainer.querySelector("#page-input");r.addEventListener("click",()=>this.previousPage()),t.addEventListener("click",()=>this.nextPage()),a.addEventListener("change",w=>{const v=w.target,f=parseInt(v.value);f>=1&&f<=A?this.jumpToPage(f):v.value=m.toString()})}showError(s){this.container.innerHTML=`
      <div style="padding: 20px; text-align: center; color: #d32f2f; border: 1px solid #d32f2f; border-radius: 4px; background: #ffebee;">
        <strong>Error:</strong> ${s}
      </div>
    `}}var xt;(function(C){C.IMAGE="image",C.VIDEO="video",C.AUDIO="audio",C.DOCUMENT="document"})(xt||(xt={}));class nt{}nt.LIGHT={name:"light",primaryColor:"#3b82f6",backgroundColor:"#ffffff",textColor:"#1f2937",borderColor:"#e5e7eb",errorColor:"#ef4444",successColor:"#10b981"};nt.DARK={name:"dark",primaryColor:"#60a5fa",backgroundColor:"#1f2937",textColor:"#f9fafb",borderColor:"#374151",errorColor:"#f87171",successColor:"#34d399"};nt.HIGH_CONTRAST={name:"high-contrast",primaryColor:"#000000",backgroundColor:"#ffffff",textColor:"#000000",borderColor:"#000000",errorColor:"#ff0000",successColor:"#008000"};class ie{static getPreset(s){return{default:ie.DEFAULT,mobile:ie.MOBILE,"desktop-hq":ie.DESKTOP_HQ,development:ie.DEVELOPMENT,performance:ie.PERFORMANCE,accessibility:ie.ACCESSIBILITY,gallery:ie.GALLERY,headless:ie.HEADLESS}[s]||null}static getAvailablePresets(){return["default","mobile","desktop-hq","development","performance","accessibility","gallery","headless"]}}ie.DEFAULT={core:{maxFileSize:100*1024*1024,supportedFormats:[xt.IMAGE],enableDebugMode:!1,performanceMode:"balanced",enableAnalytics:!1},processing:{image:{maxResolution:{width:4096,height:4096},compressionQuality:.9,enableThumbnails:!0,thumbnailSize:200,supportedFormats:["image/jpeg","image/png","image/gif","image/webp","image/svg+xml","image/bmp","image/tiff","image/tif"],enableExifParsing:!0}},rendering:{engine:"canvas",maxDimensions:{width:1920,height:1080},preserveAspectRatio:!0,backgroundColor:"transparent",antiAliasing:!0,quality:.9,enableSmoothing:!0,pixelRatio:(typeof window<"u"?window.devicePixelRatio:1)||1},ui:{theme:nt.LIGHT,pagination:{enabled:!0,showPageNumbers:!0,showControls:!0,autoHide:!1,position:"bottom"},fileInfo:{enabled:!1,showFileName:!0,showFileSize:!0,showFileType:!0,showDimensions:!0,showMetadata:!1,position:"separate"},accessibility:{enableScreenReader:!0,highContrast:!1,keyboardNavigation:!0,focusIndicators:!0,reducedMotion:!1},animations:{enabled:!0,duration:300,easing:"ease-in-out"}},performance:{preloadPages:2,memoryLimit:512*1024*1024,cacheStrategy:"moderate",lazyLoading:!0,enableWebWorkers:!0,maxConcurrentTasks:4},state:{historySize:50,enableTimeTravel:!1,persistState:!1,autoSave:!1,debounceTime:300},environment:"production"};ie.MOBILE={...ie.DEFAULT,core:{...ie.DEFAULT.core,performanceMode:"speed",maxFileSize:50*1024*1024},processing:{...ie.DEFAULT.processing,image:{...ie.DEFAULT.processing.image,maxResolution:{width:2048,height:2048},compressionQuality:.8,thumbnailSize:150}},rendering:{...ie.DEFAULT.rendering,maxDimensions:{width:800,height:600},quality:.8,antiAliasing:!1},performance:{...ie.DEFAULT.performance,preloadPages:1,memoryLimit:256*1024*1024,cacheStrategy:"minimal",enableWebWorkers:!1,maxConcurrentTasks:2},ui:{...ie.DEFAULT.ui,animations:{enabled:!1,duration:0,easing:"none"},accessibility:{...ie.DEFAULT.ui.accessibility,reducedMotion:!0}}};ie.DESKTOP_HQ={...ie.DEFAULT,core:{...ie.DEFAULT.core,performanceMode:"quality",maxFileSize:500*1024*1024},processing:{...ie.DEFAULT.processing,image:{...ie.DEFAULT.processing.image,maxResolution:{width:8192,height:8192},compressionQuality:1,thumbnailSize:300}},rendering:{...ie.DEFAULT.rendering,engine:"webgl",maxDimensions:{width:3840,height:2160},quality:1,antiAliasing:!0,enableSmoothing:!0},performance:{...ie.DEFAULT.performance,preloadPages:5,memoryLimit:2*1024*1024*1024,cacheStrategy:"aggressive",enableWebWorkers:!0,maxConcurrentTasks:8}};ie.DEVELOPMENT={...ie.DEFAULT,core:{...ie.DEFAULT.core,enableDebugMode:!0,enableAnalytics:!0},state:{...ie.DEFAULT.state,enableTimeTravel:!0,historySize:100,persistState:!0},environment:"development"};ie.PERFORMANCE={...ie.DEFAULT,core:{...ie.DEFAULT.core,performanceMode:"speed",maxFileSize:25*1024*1024},processing:{...ie.DEFAULT.processing,image:{...ie.DEFAULT.processing.image,maxResolution:{width:1024,height:1024},compressionQuality:.7,enableThumbnails:!1,enableExifParsing:!1}},rendering:{...ie.DEFAULT.rendering,maxDimensions:{width:800,height:600},quality:.7,antiAliasing:!1,enableSmoothing:!1},performance:{...ie.DEFAULT.performance,preloadPages:0,memoryLimit:128*1024*1024,cacheStrategy:"minimal",lazyLoading:!0,enableWebWorkers:!1,maxConcurrentTasks:1},ui:{...ie.DEFAULT.ui,animations:{enabled:!1,duration:0,easing:"none"}}};ie.ACCESSIBILITY={...ie.DEFAULT,ui:{...ie.DEFAULT.ui,theme:nt.HIGH_CONTRAST,accessibility:{enableScreenReader:!0,highContrast:!0,keyboardNavigation:!0,focusIndicators:!0,reducedMotion:!0},animations:{enabled:!1,duration:0,easing:"none"},pagination:{...ie.DEFAULT.ui.pagination,showPageNumbers:!0,showControls:!0}}};ie.GALLERY={...ie.DESKTOP_HQ,ui:{...ie.DESKTOP_HQ.ui,fileInfo:{enabled:!1,showFileName:!0,showFileSize:!1,showFileType:!1,showDimensions:!0,showMetadata:!0,position:"separate"},pagination:{enabled:!0,showPageNumbers:!1,showControls:!0,autoHide:!0,position:"bottom"}},processing:{...ie.DESKTOP_HQ.processing,image:{...ie.DESKTOP_HQ.processing.image,enableThumbnails:!0,thumbnailSize:400,enableExifParsing:!0}}};ie.HEADLESS={...ie.DEFAULT,rendering:{...ie.DEFAULT.rendering,engine:"canvas",maxDimensions:{width:2048,height:2048},backgroundColor:"transparent"},ui:{...ie.DEFAULT.ui,fileInfo:{enabled:!1,showFileName:!1,showFileSize:!1,showFileType:!1,showDimensions:!1,showMetadata:!1,position:"none"},pagination:{enabled:!1,showPageNumbers:!1,showControls:!1,autoHide:!0,position:"bottom"},animations:{enabled:!1,duration:0,easing:"none"}},performance:{...ie.DEFAULT.performance,enableWebWorkers:!1,lazyLoading:!1}};const Te=new dt({showFileInfo:!0,enablePagination:!0,maxDimensions:{width:1200,height:800}});let lt=null;const Xe=document.getElementById("uploadArea"),pr=document.getElementById("uploadButton"),jt=document.getElementById("fileInput"),et=document.getElementById("viewerContainer"),tt=document.getElementById("messageContainer"),Wt=document.getElementById("supportedTypes"),it=document.getElementById("filesTableBody"),at=document.getElementById("paginationControls");function wr(){console.log("Setting up pagination controls"),Te.addEventListener("pageChanged",C=>{console.log("Page changed event:",C.detail);const s=Te.getPaginationInfo();s&&Er(s.currentPage,s.totalPages)}),Te.addEventListener("loaded",()=>{console.log("File loaded event");const C=Te.getPaginationInfo();C&&C.totalPages>1?br(C.currentPage,C.totalPages):ht()}),Te.addEventListener("error",()=>{console.log("Error event - hiding pagination"),ht()})}function br(C,s){at.innerHTML=`
    <button id="prevPageBtn" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors duration-200" ${C<=1?"disabled":""}>
      ◀ Previous
    </button>
    <span class="text-gray-700 font-semibold px-2">Page</span>
    <input type="number" id="pageInput" class="w-16 px-2 py-2 border border-gray-300 rounded-lg text-center text-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent" min="1" max="${s}" value="${C}" />
    <span class="text-gray-700 font-semibold px-2">of ${s}</span>
    <button id="nextPageBtn" class="bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg disabled:bg-gray-400 disabled:cursor-not-allowed transition-colors duration-200" ${C>=s?"disabled":""}>
      Next ▶
    </button>
  `,at.classList.remove("hidden"),at.classList.add("flex");const m=document.getElementById("prevPageBtn"),A=document.getElementById("nextPageBtn"),u=document.getElementById("pageInput");m.addEventListener("click",async()=>{console.log("Previous button clicked");try{await Te.previousPage(),console.log("Previous page called")}catch(P){console.error("Error navigating to previous page:",P)}}),A.addEventListener("click",async()=>{console.log("Next button clicked");try{await Te.nextPage(),console.log("Next page called")}catch(P){console.error("Error navigating to next page:",P)}}),u.addEventListener("change",async P=>{const r=P.target,t=parseInt(r.value);if(console.log("Page input changed to:",t),t>=1&&t<=s)try{await Te.jumpToPage(t),console.log("Jump to page called with:",t)}catch(a){console.error("Error jumping to page:",a),r.value=C.toString()}else r.value=C.toString()}),u.addEventListener("keypress",P=>{P.key==="Enter"&&u.blur()})}function Er(C,s){console.log("Updating pagination controls:",{currentPage:C,totalPages:s});const m=document.getElementById("prevPageBtn"),A=document.getElementById("nextPageBtn"),u=document.getElementById("pageInput");m&&(m.disabled=C<=1,m.className=`bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200 ${C<=1?"bg-gray-400 cursor-not-allowed":"hover:bg-blue-600"}`),A&&(A.disabled=C>=s,A.className=`bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded-lg transition-colors duration-200 ${C>=s?"bg-gray-400 cursor-not-allowed":"hover:bg-blue-600"}`),u&&(u.value=C.toString(),u.max=s.toString());const P=at.querySelector("span:last-of-type");P&&(P.textContent=`of ${s}`)}function ht(){at.classList.add("hidden"),at.classList.remove("flex")}function mr(){const C=Te.getSupportedTypes();Wt.innerHTML="",C.forEach(s=>{const m=document.createElement("span");m.className="type-tag",m.textContent=s,Wt.appendChild(m)})}function yr(C){return Te.formatFileSize(C)}async function kr(){try{Be("Loading file list...",!1);const C=await fetch("http://localhost:3004/api/files");if(!C.ok)throw new Error(`API server error: ${C.statusText}. Make sure the API server is running (npm run api:start)`);const m=(await C.json()).files||[];if(it.innerHTML="",m.length===0){const P=document.createElement("tr");P.innerHTML='<td colspan="4" class="error">No files found in the files folder</td>',it.appendChild(P),Be("No files found",!0);return}m.forEach(P=>{const r=document.createElement("tr"),t=new File([""],P.name,{type:P.type}),a=Te.canHandle(t),w=a?"":"unsupported-file";r.className=w,r.innerHTML=`
        <td class="file-name" title="${P.name}">${P.name}</td>
        <td class="file-size">${yr(P.size)}</td>
        <td class="file-type">${P.type}</td>
        <td><button class="bg-green-500 hover:bg-green-600 text-white font-medium py-1 px-3 rounded text-xs transition-colors duration-200 disabled:bg-gray-400 disabled:cursor-not-allowed" data-file-path="${P.path}" data-file-name="${P.name}" data-file-type="${P.type}" ${a?"":"disabled"}>View</button></td>
      `,it.appendChild(r)}),it.querySelectorAll("button:not([disabled])").forEach(P=>{P.addEventListener("click",async r=>{const t=r.target,a=t.dataset.filePath,w=t.dataset.fileName,v=t.dataset.fileType;await Sr(a,w,v)})});const u=m.filter(P=>{const r=new File([""],P.name,{type:P.type});return Te.canHandle(r)}).length;Be(`Loaded ${m.length} files (${u} supported, ${m.length-u} unsupported)`,!1)}catch(C){it.innerHTML='<tr><td colspan="4" class="error">Failed to load example files from API server</td></tr>';const s=C instanceof Error?C.message:"Unknown error occurred";Be(`Error loading files: ${s}`,!0),console.error("Error loading file list:",C)}}async function Sr(C,s,m){try{const A=C.startsWith("http://")||C.startsWith("https://")||C.startsWith("/"),u=C.startsWith("../")||C.startsWith("./")||C.includes("files/");if(C.startsWith("/api/files/")){Be(`Loading file: ${s}...`,!1);const r=`http://localhost:3004${C}`;try{const t=await fetch(r);if(!t.ok)throw new Error(`API server error: ${t.statusText}`);const a=await t.blob(),w=new File([a],s,{type:m});await rt(w)}catch(t){const a=t instanceof Error?t.message:"Unknown API error";throw new Error(`Cannot load file via API: ${a}. Make sure the API server is running (npm run api:start).`)}}else if(A){Be("Loading file from server...",!1);const r=await fetch(C);if(!r.ok)throw new Error(`Failed to load file: ${r.statusText}`);const t=await r.blob(),a=new File([t],s,{type:m});await rt(a)}else if(u){Be(`Loading local file: ${s}...`,!1);let r=s;if(C.includes("/")){const a=C.split("/");r=a[a.length-1]}const t=`http://localhost:3004/api/files/${r}`;try{const a=await fetch(t);if(!a.ok)throw new Error(`API server error: ${a.statusText}`);const w=await a.blob(),v=new File([w],s,{type:m});await rt(v)}catch(a){const w=a instanceof Error?a.message:"Unknown API error";throw new Error(`Cannot load file via API: ${w}. Make sure the API server is running (npm run api:start) and the file exists in the files/ directory.`)}}else{Be("Attempting to load from server...",!1);try{const r=await fetch(C);if(!r.ok)throw new Error("Server file not found");const t=await r.blob(),a=new File([t],s,{type:m});await rt(a)}catch{Be(`Cannot load file: ${C}. File not found on server.`,!0),console.warn("Server loading failed for:",C)}}}catch(A){const u=A instanceof Error?A.message:"Unknown error occurred";Be(`Error loading example file: ${u}`,!0)}}function Be(C,s=!1){tt.innerHTML="";const m=document.createElement("div");m.className=`message ${s?"error":"success"}`,m.textContent=C,tt.appendChild(m),s||setTimeout(()=>{tt.contains(m)&&(m.style.transition="opacity 0.5s ease-out",m.style.opacity="0",setTimeout(()=>{tt.contains(m)&&tt.removeChild(m)},500))},3e3)}async function rt(C){try{tt.innerHTML="",et.classList.remove("viewer-container"),et.classList.add("viewer-container"),et.innerHTML="",lt=new gr(et,{showFileInfo:!0,enablePagination:!0,maxDimensions:{width:1200,height:800}});const s=await lt.loadFile(C);s.success?Be(`Successfully loaded: ${C.name}`):(Be(`Error: ${s.error}`,!0),et.innerHTML='<div class="no-file-message text-center text-gray-500 text-lg"><p>📷 Select a file from the list to view it here</p></div>',lt=null,ht())}catch(s){const m=s instanceof Error?s.message:"Unknown error occurred";Be(`Unexpected error: ${m}`,!0),et.innerHTML='<div class="no-file-message text-center text-gray-500 text-lg"><p>📷 Select a file from the list to view it here</p></div>',lt=null,ht()}}function xr(){pr.addEventListener("click",()=>{jt.click()}),jt.addEventListener("change",C=>{const m=C.target.files;m&&m.length>0&&rt(m[0])}),Xe.addEventListener("dragover",C=>{C.preventDefault(),Xe.classList.add("dragover")}),Xe.addEventListener("dragleave",C=>{C.preventDefault(),Xe.classList.remove("dragover")}),Xe.addEventListener("drop",C=>{C.preventDefault(),Xe.classList.remove("dragover");const s=C.dataTransfer?.files;s&&s.length>0&&rt(s[0])}),document.addEventListener("dragover",C=>C.preventDefault()),document.addEventListener("drop",C=>C.preventDefault())}function Kt(){console.log("🖼️ Browser File Viewer Demo initialized"),mr(),kr(),xr(),wr()}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",Kt):Kt();
